(function () {
const openItem = item => {
  const container = item.closest(".team__item");
  const contentBlock = container.find(".team__content");
  const textBlock = contentBlock.find(".team__content-block");
  const reqHeight = textBlock.height();

  container.addClass('active');
  contentBlock.height(reqHeight);
}

const closeEveryItem = container => {
  const items = container.find(".team__content")
  const ItemContainer = container.find(".team__item");

  ItemContainer.removeClass("active");
  items.height(0);
};

$('.team__title').click(e => {
  const $this = $(e.currentTarget);
  const container = $this.closest(".team");
  const elemContainer = $this.closest(".team__item");

  if (elemContainer.hasClass("active")) {
    closeEveryItem(container);
  } else {
    closeEveryItem(container);
    openItem($this);
  }
});
})();(function () {
const hamburger = document.querySelector("#hamburger");
const fullscreenMenu = document.querySelector(".fullscreen-menu");
const close = document.querySelector(".fullscreen-menu__close")
const body = document.body;
const menuItem = $(".menu__item");

hamburger.addEventListener("click", e => {
  e.preventDefault();

  fullscreenMenu.classList.add("active");
  body.classList.add("body-active-menu");
})

close.addEventListener("click", e => {
  e.preventDefault();

  fullscreenMenu.classList.remove("active");
  body.classList.remove("body-active-menu");
})

menuItem.on("click", function () {
  if ($(fullscreenMenu).hasClass("active")) {
    fullscreenMenu.classList.remove("active");
    body.classList.remove("body-active-menu");
  }
})
})();/*!
 * @fileOverview TouchSwipe - jQuery Plugin
 * @version 1.6.18
 *
 * @author Matt Bryson http://www.github.com/mattbryson
 * @see https://github.com/mattbryson/TouchSwipe-Jquery-Plugin
 * @see http://labs.rampinteractive.co.uk/touchSwipe/
 * @see http://plugins.jquery.com/project/touchSwipe
 * @license
 * Copyright (c) 2010-2015 Matt Bryson
 * Dual licensed under the MIT or GPL Version 2 licenses.
 *
 */

!function(factory){"function"==typeof define&&define.amd&&define.amd.jQuery?define(["jquery"],factory):factory("undefined"!=typeof module&&module.exports?require("jquery"):jQuery)}(function($){"use strict";function init(options){return!options||void 0!==options.allowPageScroll||void 0===options.swipe&&void 0===options.swipeStatus||(options.allowPageScroll=NONE),void 0!==options.click&&void 0===options.tap&&(options.tap=options.click),options||(options={}),options=$.extend({},$.fn.swipe.defaults,options),this.each(function(){var $this=$(this),plugin=$this.data(PLUGIN_NS);plugin||(plugin=new TouchSwipe(this,options),$this.data(PLUGIN_NS,plugin))})}function TouchSwipe(element,options){function touchStart(jqEvent){if(!(getTouchInProgress()||$(jqEvent.target).closest(options.excludedElements,$element).length>0)){var event=jqEvent.originalEvent?jqEvent.originalEvent:jqEvent;if(!event.pointerType||"mouse"!=event.pointerType||0!=options.fallbackToMouseEvents){var ret,touches=event.touches,evt=touches?touches[0]:event;return phase=PHASE_START,touches?fingerCount=touches.length:options.preventDefaultEvents!==!1&&jqEvent.preventDefault(),distance=0,direction=null,currentDirection=null,pinchDirection=null,duration=0,startTouchesDistance=0,endTouchesDistance=0,pinchZoom=1,pinchDistance=0,maximumsMap=createMaximumsData(),cancelMultiFingerRelease(),createFingerData(0,evt),!touches||fingerCount===options.fingers||options.fingers===ALL_FINGERS||hasPinches()?(startTime=getTimeStamp(),2==fingerCount&&(createFingerData(1,touches[1]),startTouchesDistance=endTouchesDistance=calculateTouchesDistance(fingerData[0].start,fingerData[1].start)),(options.swipeStatus||options.pinchStatus)&&(ret=triggerHandler(event,phase))):ret=!1,ret===!1?(phase=PHASE_CANCEL,triggerHandler(event,phase),ret):(options.hold&&(holdTimeout=setTimeout($.proxy(function(){$element.trigger("hold",[event.target]),options.hold&&(ret=options.hold.call($element,event,event.target))},this),options.longTapThreshold)),setTouchInProgress(!0),null)}}}function touchMove(jqEvent){var event=jqEvent.originalEvent?jqEvent.originalEvent:jqEvent;if(phase!==PHASE_END&&phase!==PHASE_CANCEL&&!inMultiFingerRelease()){var ret,touches=event.touches,evt=touches?touches[0]:event,currentFinger=updateFingerData(evt);if(endTime=getTimeStamp(),touches&&(fingerCount=touches.length),options.hold&&clearTimeout(holdTimeout),phase=PHASE_MOVE,2==fingerCount&&(0==startTouchesDistance?(createFingerData(1,touches[1]),startTouchesDistance=endTouchesDistance=calculateTouchesDistance(fingerData[0].start,fingerData[1].start)):(updateFingerData(touches[1]),endTouchesDistance=calculateTouchesDistance(fingerData[0].end,fingerData[1].end),pinchDirection=calculatePinchDirection(fingerData[0].end,fingerData[1].end)),pinchZoom=calculatePinchZoom(startTouchesDistance,endTouchesDistance),pinchDistance=Math.abs(startTouchesDistance-endTouchesDistance)),fingerCount===options.fingers||options.fingers===ALL_FINGERS||!touches||hasPinches()){if(direction=calculateDirection(currentFinger.start,currentFinger.end),currentDirection=calculateDirection(currentFinger.last,currentFinger.end),validateDefaultEvent(jqEvent,currentDirection),distance=calculateDistance(currentFinger.start,currentFinger.end),duration=calculateDuration(),setMaxDistance(direction,distance),ret=triggerHandler(event,phase),!options.triggerOnTouchEnd||options.triggerOnTouchLeave){var inBounds=!0;if(options.triggerOnTouchLeave){var bounds=getbounds(this);inBounds=isInBounds(currentFinger.end,bounds)}!options.triggerOnTouchEnd&&inBounds?phase=getNextPhase(PHASE_MOVE):options.triggerOnTouchLeave&&!inBounds&&(phase=getNextPhase(PHASE_END)),phase!=PHASE_CANCEL&&phase!=PHASE_END||triggerHandler(event,phase)}}else phase=PHASE_CANCEL,triggerHandler(event,phase);ret===!1&&(phase=PHASE_CANCEL,triggerHandler(event,phase))}}function touchEnd(jqEvent){var event=jqEvent.originalEvent?jqEvent.originalEvent:jqEvent,touches=event.touches;if(touches){if(touches.length&&!inMultiFingerRelease())return startMultiFingerRelease(event),!0;if(touches.length&&inMultiFingerRelease())return!0}return inMultiFingerRelease()&&(fingerCount=fingerCountAtRelease),endTime=getTimeStamp(),duration=calculateDuration(),didSwipeBackToCancel()||!validateSwipeDistance()?(phase=PHASE_CANCEL,triggerHandler(event,phase)):options.triggerOnTouchEnd||options.triggerOnTouchEnd===!1&&phase===PHASE_MOVE?(options.preventDefaultEvents!==!1&&jqEvent.preventDefault(),phase=PHASE_END,triggerHandler(event,phase)):!options.triggerOnTouchEnd&&hasTap()?(phase=PHASE_END,triggerHandlerForGesture(event,phase,TAP)):phase===PHASE_MOVE&&(phase=PHASE_CANCEL,triggerHandler(event,phase)),setTouchInProgress(!1),null}function touchCancel(){fingerCount=0,endTime=0,startTime=0,startTouchesDistance=0,endTouchesDistance=0,pinchZoom=1,cancelMultiFingerRelease(),setTouchInProgress(!1)}function touchLeave(jqEvent){var event=jqEvent.originalEvent?jqEvent.originalEvent:jqEvent;options.triggerOnTouchLeave&&(phase=getNextPhase(PHASE_END),triggerHandler(event,phase))}function removeListeners(){$element.unbind(START_EV,touchStart),$element.unbind(CANCEL_EV,touchCancel),$element.unbind(MOVE_EV,touchMove),$element.unbind(END_EV,touchEnd),LEAVE_EV&&$element.unbind(LEAVE_EV,touchLeave),setTouchInProgress(!1)}function getNextPhase(currentPhase){var nextPhase=currentPhase,validTime=validateSwipeTime(),validDistance=validateSwipeDistance(),didCancel=didSwipeBackToCancel();return!validTime||didCancel?nextPhase=PHASE_CANCEL:!validDistance||currentPhase!=PHASE_MOVE||options.triggerOnTouchEnd&&!options.triggerOnTouchLeave?!validDistance&&currentPhase==PHASE_END&&options.triggerOnTouchLeave&&(nextPhase=PHASE_CANCEL):nextPhase=PHASE_END,nextPhase}function triggerHandler(event,phase){var ret,touches=event.touches;return(didSwipe()||hasSwipes())&&(ret=triggerHandlerForGesture(event,phase,SWIPE)),(didPinch()||hasPinches())&&ret!==!1&&(ret=triggerHandlerForGesture(event,phase,PINCH)),didDoubleTap()&&ret!==!1?ret=triggerHandlerForGesture(event,phase,DOUBLE_TAP):didLongTap()&&ret!==!1?ret=triggerHandlerForGesture(event,phase,LONG_TAP):didTap()&&ret!==!1&&(ret=triggerHandlerForGesture(event,phase,TAP)),phase===PHASE_CANCEL&&touchCancel(event),phase===PHASE_END&&(touches?touches.length||touchCancel(event):touchCancel(event)),ret}function triggerHandlerForGesture(event,phase,gesture){var ret;if(gesture==SWIPE){if($element.trigger("swipeStatus",[phase,direction||null,distance||0,duration||0,fingerCount,fingerData,currentDirection]),options.swipeStatus&&(ret=options.swipeStatus.call($element,event,phase,direction||null,distance||0,duration||0,fingerCount,fingerData,currentDirection),ret===!1))return!1;if(phase==PHASE_END&&validateSwipe()){if(clearTimeout(singleTapTimeout),clearTimeout(holdTimeout),$element.trigger("swipe",[direction,distance,duration,fingerCount,fingerData,currentDirection]),options.swipe&&(ret=options.swipe.call($element,event,direction,distance,duration,fingerCount,fingerData,currentDirection),ret===!1))return!1;switch(direction){case LEFT:$element.trigger("swipeLeft",[direction,distance,duration,fingerCount,fingerData,currentDirection]),options.swipeLeft&&(ret=options.swipeLeft.call($element,event,direction,distance,duration,fingerCount,fingerData,currentDirection));break;case RIGHT:$element.trigger("swipeRight",[direction,distance,duration,fingerCount,fingerData,currentDirection]),options.swipeRight&&(ret=options.swipeRight.call($element,event,direction,distance,duration,fingerCount,fingerData,currentDirection));break;case UP:$element.trigger("swipeUp",[direction,distance,duration,fingerCount,fingerData,currentDirection]),options.swipeUp&&(ret=options.swipeUp.call($element,event,direction,distance,duration,fingerCount,fingerData,currentDirection));break;case DOWN:$element.trigger("swipeDown",[direction,distance,duration,fingerCount,fingerData,currentDirection]),options.swipeDown&&(ret=options.swipeDown.call($element,event,direction,distance,duration,fingerCount,fingerData,currentDirection))}}}if(gesture==PINCH){if($element.trigger("pinchStatus",[phase,pinchDirection||null,pinchDistance||0,duration||0,fingerCount,pinchZoom,fingerData]),options.pinchStatus&&(ret=options.pinchStatus.call($element,event,phase,pinchDirection||null,pinchDistance||0,duration||0,fingerCount,pinchZoom,fingerData),ret===!1))return!1;if(phase==PHASE_END&&validatePinch())switch(pinchDirection){case IN:$element.trigger("pinchIn",[pinchDirection||null,pinchDistance||0,duration||0,fingerCount,pinchZoom,fingerData]),options.pinchIn&&(ret=options.pinchIn.call($element,event,pinchDirection||null,pinchDistance||0,duration||0,fingerCount,pinchZoom,fingerData));break;case OUT:$element.trigger("pinchOut",[pinchDirection||null,pinchDistance||0,duration||0,fingerCount,pinchZoom,fingerData]),options.pinchOut&&(ret=options.pinchOut.call($element,event,pinchDirection||null,pinchDistance||0,duration||0,fingerCount,pinchZoom,fingerData))}}return gesture==TAP?phase!==PHASE_CANCEL&&phase!==PHASE_END||(clearTimeout(singleTapTimeout),clearTimeout(holdTimeout),hasDoubleTap()&&!inDoubleTap()?(doubleTapStartTime=getTimeStamp(),singleTapTimeout=setTimeout($.proxy(function(){doubleTapStartTime=null,$element.trigger("tap",[event.target]),options.tap&&(ret=options.tap.call($element,event,event.target))},this),options.doubleTapThreshold)):(doubleTapStartTime=null,$element.trigger("tap",[event.target]),options.tap&&(ret=options.tap.call($element,event,event.target)))):gesture==DOUBLE_TAP?phase!==PHASE_CANCEL&&phase!==PHASE_END||(clearTimeout(singleTapTimeout),clearTimeout(holdTimeout),doubleTapStartTime=null,$element.trigger("doubletap",[event.target]),options.doubleTap&&(ret=options.doubleTap.call($element,event,event.target))):gesture==LONG_TAP&&(phase!==PHASE_CANCEL&&phase!==PHASE_END||(clearTimeout(singleTapTimeout),doubleTapStartTime=null,$element.trigger("longtap",[event.target]),options.longTap&&(ret=options.longTap.call($element,event,event.target)))),ret}function validateSwipeDistance(){var valid=!0;return null!==options.threshold&&(valid=distance>=options.threshold),valid}function didSwipeBackToCancel(){var cancelled=!1;return null!==options.cancelThreshold&&null!==direction&&(cancelled=getMaxDistance(direction)-distance>=options.cancelThreshold),cancelled}function validatePinchDistance(){return null===options.pinchThreshold||pinchDistance>=options.pinchThreshold}function validateSwipeTime(){var result;return result=!options.maxTimeThreshold||!(duration>=options.maxTimeThreshold)}function validateDefaultEvent(jqEvent,direction){if(options.preventDefaultEvents!==!1)if(options.allowPageScroll===NONE)jqEvent.preventDefault();else{var auto=options.allowPageScroll===AUTO;switch(direction){case LEFT:(options.swipeLeft&&auto||!auto&&options.allowPageScroll!=HORIZONTAL)&&jqEvent.preventDefault();break;case RIGHT:(options.swipeRight&&auto||!auto&&options.allowPageScroll!=HORIZONTAL)&&jqEvent.preventDefault();break;case UP:(options.swipeUp&&auto||!auto&&options.allowPageScroll!=VERTICAL)&&jqEvent.preventDefault();break;case DOWN:(options.swipeDown&&auto||!auto&&options.allowPageScroll!=VERTICAL)&&jqEvent.preventDefault();break;case NONE:}}}function validatePinch(){var hasCorrectFingerCount=validateFingers(),hasEndPoint=validateEndPoint(),hasCorrectDistance=validatePinchDistance();return hasCorrectFingerCount&&hasEndPoint&&hasCorrectDistance}function hasPinches(){return!!(options.pinchStatus||options.pinchIn||options.pinchOut)}function didPinch(){return!(!validatePinch()||!hasPinches())}function validateSwipe(){var hasValidTime=validateSwipeTime(),hasValidDistance=validateSwipeDistance(),hasCorrectFingerCount=validateFingers(),hasEndPoint=validateEndPoint(),didCancel=didSwipeBackToCancel(),valid=!didCancel&&hasEndPoint&&hasCorrectFingerCount&&hasValidDistance&&hasValidTime;return valid}function hasSwipes(){return!!(options.swipe||options.swipeStatus||options.swipeLeft||options.swipeRight||options.swipeUp||options.swipeDown)}function didSwipe(){return!(!validateSwipe()||!hasSwipes())}function validateFingers(){return fingerCount===options.fingers||options.fingers===ALL_FINGERS||!SUPPORTS_TOUCH}function validateEndPoint(){return 0!==fingerData[0].end.x}function hasTap(){return!!options.tap}function hasDoubleTap(){return!!options.doubleTap}function hasLongTap(){return!!options.longTap}function validateDoubleTap(){if(null==doubleTapStartTime)return!1;var now=getTimeStamp();return hasDoubleTap()&&now-doubleTapStartTime<=options.doubleTapThreshold}function inDoubleTap(){return validateDoubleTap()}function validateTap(){return(1===fingerCount||!SUPPORTS_TOUCH)&&(isNaN(distance)||distance<options.threshold)}function validateLongTap(){return duration>options.longTapThreshold&&distance<DOUBLE_TAP_THRESHOLD}function didTap(){return!(!validateTap()||!hasTap())}function didDoubleTap(){return!(!validateDoubleTap()||!hasDoubleTap())}function didLongTap(){return!(!validateLongTap()||!hasLongTap())}function startMultiFingerRelease(event){previousTouchEndTime=getTimeStamp(),fingerCountAtRelease=event.touches.length+1}function cancelMultiFingerRelease(){previousTouchEndTime=0,fingerCountAtRelease=0}function inMultiFingerRelease(){var withinThreshold=!1;if(previousTouchEndTime){var diff=getTimeStamp()-previousTouchEndTime;diff<=options.fingerReleaseThreshold&&(withinThreshold=!0)}return withinThreshold}function getTouchInProgress(){return!($element.data(PLUGIN_NS+"_intouch")!==!0)}function setTouchInProgress(val){$element&&(val===!0?($element.bind(MOVE_EV,touchMove),$element.bind(END_EV,touchEnd),LEAVE_EV&&$element.bind(LEAVE_EV,touchLeave)):($element.unbind(MOVE_EV,touchMove,!1),$element.unbind(END_EV,touchEnd,!1),LEAVE_EV&&$element.unbind(LEAVE_EV,touchLeave,!1)),$element.data(PLUGIN_NS+"_intouch",val===!0))}function createFingerData(id,evt){var f={start:{x:0,y:0},last:{x:0,y:0},end:{x:0,y:0}};return f.start.x=f.last.x=f.end.x=evt.pageX||evt.clientX,f.start.y=f.last.y=f.end.y=evt.pageY||evt.clientY,fingerData[id]=f,f}function updateFingerData(evt){var id=void 0!==evt.identifier?evt.identifier:0,f=getFingerData(id);return null===f&&(f=createFingerData(id,evt)),f.last.x=f.end.x,f.last.y=f.end.y,f.end.x=evt.pageX||evt.clientX,f.end.y=evt.pageY||evt.clientY,f}function getFingerData(id){return fingerData[id]||null}function setMaxDistance(direction,distance){direction!=NONE&&(distance=Math.max(distance,getMaxDistance(direction)),maximumsMap[direction].distance=distance)}function getMaxDistance(direction){if(maximumsMap[direction])return maximumsMap[direction].distance}function createMaximumsData(){var maxData={};return maxData[LEFT]=createMaximumVO(LEFT),maxData[RIGHT]=createMaximumVO(RIGHT),maxData[UP]=createMaximumVO(UP),maxData[DOWN]=createMaximumVO(DOWN),maxData}function createMaximumVO(dir){return{direction:dir,distance:0}}function calculateDuration(){return endTime-startTime}function calculateTouchesDistance(startPoint,endPoint){var diffX=Math.abs(startPoint.x-endPoint.x),diffY=Math.abs(startPoint.y-endPoint.y);return Math.round(Math.sqrt(diffX*diffX+diffY*diffY))}function calculatePinchZoom(startDistance,endDistance){var percent=endDistance/startDistance*1;return percent.toFixed(2)}function calculatePinchDirection(){return pinchZoom<1?OUT:IN}function calculateDistance(startPoint,endPoint){return Math.round(Math.sqrt(Math.pow(endPoint.x-startPoint.x,2)+Math.pow(endPoint.y-startPoint.y,2)))}function calculateAngle(startPoint,endPoint){var x=startPoint.x-endPoint.x,y=endPoint.y-startPoint.y,r=Math.atan2(y,x),angle=Math.round(180*r/Math.PI);return angle<0&&(angle=360-Math.abs(angle)),angle}function calculateDirection(startPoint,endPoint){if(comparePoints(startPoint,endPoint))return NONE;var angle=calculateAngle(startPoint,endPoint);return angle<=45&&angle>=0?LEFT:angle<=360&&angle>=315?LEFT:angle>=135&&angle<=225?RIGHT:angle>45&&angle<135?DOWN:UP}function getTimeStamp(){var now=new Date;return now.getTime()}function getbounds(el){el=$(el);var offset=el.offset(),bounds={left:offset.left,right:offset.left+el.outerWidth(),top:offset.top,bottom:offset.top+el.outerHeight()};return bounds}function isInBounds(point,bounds){return point.x>bounds.left&&point.x<bounds.right&&point.y>bounds.top&&point.y<bounds.bottom}function comparePoints(pointA,pointB){return pointA.x==pointB.x&&pointA.y==pointB.y}var options=$.extend({},options),useTouchEvents=SUPPORTS_TOUCH||SUPPORTS_POINTER||!options.fallbackToMouseEvents,START_EV=useTouchEvents?SUPPORTS_POINTER?SUPPORTS_POINTER_IE10?"MSPointerDown":"pointerdown":"touchstart":"mousedown",MOVE_EV=useTouchEvents?SUPPORTS_POINTER?SUPPORTS_POINTER_IE10?"MSPointerMove":"pointermove":"touchmove":"mousemove",END_EV=useTouchEvents?SUPPORTS_POINTER?SUPPORTS_POINTER_IE10?"MSPointerUp":"pointerup":"touchend":"mouseup",LEAVE_EV=useTouchEvents?SUPPORTS_POINTER?"mouseleave":null:"mouseleave",CANCEL_EV=SUPPORTS_POINTER?SUPPORTS_POINTER_IE10?"MSPointerCancel":"pointercancel":"touchcancel",distance=0,direction=null,currentDirection=null,duration=0,startTouchesDistance=0,endTouchesDistance=0,pinchZoom=1,pinchDistance=0,pinchDirection=0,maximumsMap=null,$element=$(element),phase="start",fingerCount=0,fingerData={},startTime=0,endTime=0,previousTouchEndTime=0,fingerCountAtRelease=0,doubleTapStartTime=0,singleTapTimeout=null,holdTimeout=null;try{$element.bind(START_EV,touchStart),$element.bind(CANCEL_EV,touchCancel)}catch(e){$.error("events not supported "+START_EV+","+CANCEL_EV+" on jQuery.swipe")}this.enable=function(){return this.disable(),$element.bind(START_EV,touchStart),$element.bind(CANCEL_EV,touchCancel),$element},this.disable=function(){return removeListeners(),$element},this.destroy=function(){removeListeners(),$element.data(PLUGIN_NS,null),$element=null},this.option=function(property,value){if("object"==typeof property)options=$.extend(options,property);else if(void 0!==options[property]){if(void 0===value)return options[property];options[property]=value}else{if(!property)return options;$.error("Option "+property+" does not exist on jQuery.swipe.options")}return null}}var VERSION="1.6.18",LEFT="left",RIGHT="right",UP="up",DOWN="down",IN="in",OUT="out",NONE="none",AUTO="auto",SWIPE="swipe",PINCH="pinch",TAP="tap",DOUBLE_TAP="doubletap",LONG_TAP="longtap",HORIZONTAL="horizontal",VERTICAL="vertical",ALL_FINGERS="all",DOUBLE_TAP_THRESHOLD=10,PHASE_START="start",PHASE_MOVE="move",PHASE_END="end",PHASE_CANCEL="cancel",SUPPORTS_TOUCH="ontouchstart"in window,SUPPORTS_POINTER_IE10=window.navigator.msPointerEnabled&&!window.PointerEvent&&!SUPPORTS_TOUCH,SUPPORTS_POINTER=(window.PointerEvent||window.navigator.msPointerEnabled)&&!SUPPORTS_TOUCH,PLUGIN_NS="TouchSwipe",defaults={fingers:1,threshold:75,cancelThreshold:null,pinchThreshold:20,maxTimeThreshold:null,fingerReleaseThreshold:250,longTapThreshold:500,doubleTapThreshold:200,swipe:null,swipeLeft:null,swipeRight:null,swipeUp:null,swipeDown:null,swipeStatus:null,pinchIn:null,pinchOut:null,pinchStatus:null,click:null,tap:null,doubleTap:null,longTap:null,hold:null,triggerOnTouchEnd:!0,triggerOnTouchLeave:!1,allowPageScroll:"auto",fallbackToMouseEvents:!0,excludedElements:".noSwipe",preventDefaultEvents:!0};$.fn.swipe=function(method){var $this=$(this),plugin=$this.data(PLUGIN_NS);if(plugin&&"string"==typeof method){if(plugin[method])return plugin[method].apply(plugin,Array.prototype.slice.call(arguments,1));$.error("Method "+method+" does not exist on jQuery.swipe")}else if(plugin&&"object"==typeof method)plugin.option.apply(plugin,arguments);else if(!(plugin||"object"!=typeof method&&method))return init.apply(this,arguments);return $this},$.fn.swipe.version=VERSION,$.fn.swipe.defaults=defaults,$.fn.swipe.phases={PHASE_START:PHASE_START,PHASE_MOVE:PHASE_MOVE,PHASE_END:PHASE_END,PHASE_CANCEL:PHASE_CANCEL},$.fn.swipe.directions={LEFT:LEFT,RIGHT:RIGHT,UP:UP,DOWN:DOWN,IN:IN,OUT:OUT},$.fn.swipe.pageScroll={NONE:NONE,HORIZONTAL:HORIZONTAL,VERTICAL:VERTICAL,AUTO:AUTO},$.fn.swipe.fingers={ONE:1,TWO:2,THREE:3,FOUR:4,FIVE:5,ALL:ALL_FINGERS}});

;(function () {
let myMap;

const init = () => {
  myMap = new ymaps.Map("map", {
    center: [45.040768, 38.989612],
    zoom: 12,
    controls: [],
  });

  const coords = [
    [45.053787, 38.974663],
    [45.022882, 39.103893],
    [45.023913, 38.938908],
    [45.007112, 38.971023]
  ];

  const mediaQueryTablets = window.matchMedia('(max-width: 768px)');
  if (mediaQueryTablets.matches) {
    var myCollection = new ymaps.GeoObjectCollection({}, {
    draggable: false, 
    iconLayout: 'default#image',
    iconImageHref: "./img/marker.svg",
    iconImageSize: [43, 55],
    iconImageOffset: [-3, -42]
  });
  } else {
    var myCollection = new ymaps.GeoObjectCollection({}, {
      draggable: false, 
      iconLayout: 'default#image',
      iconImageHref: "./img/marker.svg",
      iconImageSize: [58, 73],
      iconImageOffset: [-3, -42]
    });
  }
 
  coords.forEach(coord => {
    myCollection.add(new ymaps.Placemark(coord));
  });

  myMap.geoObjects.add(myCollection);

  myMap.behaviors.disable('scrollZoom');

}

ymaps.ready(init);
})();(function () {
const isPhones = window.matchMedia('(max-width: 480px)').matches;
const isTablets = window.matchMedia('(max-width: 840px)').matches;


const mesureWidth = item => {
  let reqItemWidth = 0;

  const screenWidth = $(window).width();
  const container = item.closest(".products-menu");
  const titlesBlocks = container.find(".products-menu__title");
  const titleWidth = titlesBlocks.width() * titlesBlocks.length;

  const textContainer = item.find(".products-menu__content-text");
  const paddingLeft = parseInt(textContainer.css("padding-left"));
  const paddingRight = parseInt(textContainer.css("padding-right"));

 
  if (isPhones) {
    reqItemWidth = screenWidth - titlesBlocks.width();
  } else if (isTablets) {
    reqItemWidth = screenWidth - titleWidth;
  } else {
    reqItemWidth = 524;
  }

  
  return {
    container: reqItemWidth,
    textContainer: reqItemWidth - paddingLeft - paddingRight
  }

};


const closeEveryItemInContainer = container => {
  const items = container.find(".products-menu__item");
  const content = container.find(".products-menu__content");

  items.removeClass("active");
  content.width(0);
}


const openThisItem = (item) => {
  const hiddenContent = item.find(".products-menu__content");
  const reqWidth = mesureWidth(item);
  const textBlock = item.find(".products-menu__content-text");

  item.addClass("active");
  hiddenContent.width(reqWidth.container);
  textBlock.width(reqWidth.textContainer);
}


$(".products-menu__title").on("click", e => {
  e.preventDefault();

  const $this = $(e.currentTarget);
  const item = $this.closest(".products-menu__item");
  const itemOpened = item.hasClass("active");
  const container = $this.closest(".products-menu"); 

  
  if (itemOpened) {
    closeEveryItemInContainer(container);
  } else {
    closeEveryItemInContainer(container); 
    openThisItem(item); 
  }

  
  if (isPhones) {
    if (item.hasClass("active-mobile")) {
      item.removeClass("active-mobile");
    } else {
      item.addClass("active-mobile");
    }
  }
});
})();(function () {
const validateFields = (form, fieldsArray) => {
  fieldsArray.forEach(field => {
    field.removeClass("form__input--error");
    if (field.val().trim() == "") {
      field.addClass("form__input--error");
    }
  });

  const errorFields = form.find(".form__input--error");

  return errorFields.length == 0;
}

$('.form').submit(e => {
  e.preventDefault();

  const form = $(e.currentTarget);
  const name = form.find("[name='name']");
  const phone = form.find("[name='phone']");
  const comment = form.find("[name='comment']");
  const to = form.find("[name='to']");

  const modal = $("#modal");
  const content = modal.find(".modal__content");

  modal.removeClass("error-modal");

  const isValid = validateFields(form, [name, phone, comment, to]);

  if (isValid) {
    const request = $.ajax({
      url: "https://webdev-api.loftschool.com/sendmail",
      method: "post",
      data: {
        name: name.val(),
        phone: phone.val(),
        comment: comment.val(),
        to: to.val(),
      },
      error: data => {

      }
    });

    request.done(data => {
      content.text(data.message);
    });

    request.fail(data => {
      const message = data.responseJSON.message;
      content.text(message);
      modal.addClass("error-modal");
    });

    request.always(() => {
      $.fancybox.open({
        src: "#modal",
        type: "inline"
      })
    })
  }
});

$(".app-submit-btn").click(e => {
  e.preventDefault();

  $.fancybox.close();
});
})();(function () {
const sections = $("section");
const display = $(".maincontent");
const sideMenu = $(".fixed-menu");
const menuItems = sideMenu.find(".fixed-menu__item");

let inScroll = false;



const mobileDetect = new MobileDetect(window.navigator.userAgent);
const isMobile = mobileDetect.mobile();

sections.first().addClass("active");
$(".fixed-menu__item").first().addClass("fixed-menu__item--active");


const countSectionPosition = sectionEq => {
  const position = sectionEq * -100;

  if (isNaN(position)) {
    console.error('передано неверное значение в countSectionPosition');
    return 0;
  }
  return position;
}


const changeMenuThemeForSection = (sectionEq) => {
  const currentSection = sections.eq(sectionEq);
  const menuTheme = currentSection.attr("data-sidemenu-theme")
  const activeClass = "fixed-menu__item--active";

  sideMenu.find(".fixed-menu__item").eq(sectionEq).addClass(activeClass).siblings().removeClass(activeClass);

  if (menuTheme === "dark") {
    sideMenu.addClass("fixed-menu--theme-dark");
  } else {
    sideMenu.removeClass("fixed-menu--theme-dark");
  }
}


const resetActiveClassForItem = (items, itemEq, activeClass) => {
  items.eq(itemEq).addClass(activeClass).siblings().removeClass(activeClass);
}


const performTransition = sectionEq => {

  if (inScroll) return;

  const transitionOver = 1000;
  const mouseInertionOver = 300;

  inScroll = true;
  const position = countSectionPosition(sectionEq);

  changeMenuThemeForSection(sectionEq);

  display.css({
    transform: `translateY(${position}%)`
  });

  resetActiveClassForItem(sections, sectionEq, "active");



  setTimeout(() => {
    inScroll = false;
    resetActiveClassForItem(menuItems, sectionEq, "fixed-menu__item--active");
  }, transitionOver + mouseInertionOver);

};


const viewportScroller = () => {
  const activeSection = sections.filter(".active");
  const nextSection = activeSection.next();
  const prevSection = activeSection.prev();

  return {
    next() {
      if (nextSection.length) {
        performTransition(nextSection.index());
      }
    },
    prev() {
      if (prevSection.length) {
        performTransition(prevSection.index());
      }
    }
  }
};


$(window).on("wheel", e => {
  const deltaY = e.originalEvent.deltaY;
  const scroller = viewportScroller();

  if (deltaY > 0) {
    scroller.next();
  }

  if (deltaY < 0) {
    scroller.prev();
  }
});


$(window).on("keydown", (e) => {

  const tagName = e.target.tagName.toLowerCase();
  const userTypingInInputs = tagName == "input" || tagName == "textarea";
  const scroller = viewportScroller();

  if (userTypingInInputs) return;

 
  switch (e.keyCode) {
    case 38: 
      scroller.prev();
      break;

    case 40: 
      scroller.next();
      break;
  }

});

$(".wrapper").on("touchmove", e => e.preventDefault());


$("[data-scroll-to]").on("click", e => {
  e.preventDefault();

  const $this = $(e.currentTarget);
  const target = $this.attr("data-scroll-to");
  const reqSection = $(`[data-section-id=${target}]`);

  performTransition(reqSection.index());
});


if (isMobile) {
  $("body").swipe({
    swipe: function (event, direction) {
      const scroller = viewportScroller();
      let scrollDirecrion = "";

      if (direction === "up") scrollDirecrion = "next";
      if (direction === "down") scrollDirecrion = "prev";

      scroller[scrollDirecrion]();
    }
  });
}
})();(function () {
const playerContainer = document.querySelector('.player');
const playerWrapper = document.querySelector('.player__wrapper');
const video = document.querySelector('.player__video');
const playerStart = document.querySelector('.player__controls-start');
const playerPaused = document.querySelector('.player__paused');
const progressBar = document.querySelector('.player__playback-line');
const playerVideoCircle = document.querySelector('.player__playback-circle');
const playerVolumeIcon = document.querySelector('.player__mute');
const playerVolumeBar = document.querySelector('.player__volume-line');
const playerVolumeCircle = document.querySelector('.player__volume-circle');

let startVolume = 0;
let currentVolume;



const handleStart = () => {
  if (video.paused) {
    video.play();
  } else {
    video.pause();
  }  
}

playerStart.addEventListener('click', handleStart);
playerPaused.addEventListener('click', handleStart);
playerWrapper.addEventListener('click', handleStart);



video.onplay = () => {
  togglePlayer();
}

video.onpause = () => {
  togglePlayer("pause");
}

const togglePlayer = (action = "start") => {
  if (action === "start") {
    playerContainer.classList.add("active");
  } else {
    playerContainer.classList.remove("active");
  }
}



const changeVolume = (e) => {
  const currentTarget = e.currentTarget;
  const left = currentTarget.getBoundingClientRect().left;
  const soundBarWidth = parseInt(getComputedStyle(currentTarget).width);
  const newPosition = e.pageX - left; 
  const percentValue = (newPosition / soundBarWidth) * 100;

  video.volume = percentValue / 100;
  playerVolumeCircle.style.left = `${percentValue}%`; 


  if (video.volume > 0) {
    playerContainer.classList.remove('muted');
  }
}

const toggleSound = () => {
  playerContainer.classList.toggle('muted');

  if (video.volume === 0) {
   
    video.volume = currentVolume;
    playerVolumeCircle.style.left = `${currentVolume * 100}%`;
  } else {
   
    currentVolume = video.volume;
    video.volume = startVolume;
    playerVolumeCircle.style.left = `${startVolume}%`;
  }
}

playerVolumeIcon.addEventListener('click', toggleSound);
playerVolumeBar.addEventListener('click', changeVolume);



const handleDuration = (e) => {
  const barSize = parseInt(getComputedStyle(progressBar).width);
  const circleWidth = parseInt(getComputedStyle(playerVideoCircle).width);
  const offsetX = e.offsetX;

  const newSize = offsetX + circleWidth / 2;
  const newTime = (newSize * video.duration) / barSize;
  video.currentTime = newTime;
}

const updateTime = () => {
  const lineBar = video.currentTime / video.duration;
  playerVideoCircle.style.left = `${lineBar * 100}%`;

  if (video.ended) {
    video.currentTime = 0;
  }
}

progressBar.addEventListener('click', handleDuration);
video.addEventListener('timeupdate', updateTime);
})();(function () {
  $('.slider__list').slick({
     prevArrow: $('.slider__btn--left'),
     nextArrow: $('.slider__btn--right'),
   });
 })();(function () {
const findBlockByAlias = (alias) => {
  return $(".reviews__item").filter((ndx, item) => {
    return $(item).attr("data-linked-with") == alias
  });
}

$(".interactive-avatar__link").click(e => {
  e.preventDefault();

  const $this = $(e.currentTarget);
  const target = $this.attr("data-open");
  const itemToShow = findBlockByAlias(target);
  const curItem = $this.closest(".reviews__switcher-item");

  itemToShow.addClass("active").siblings().removeClass("active");
  curItem.addClass("active").siblings().removeClass("active");
});
})()
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFjY29yZGVvbi5qcyIsImZ1bGxzY3JlZW5NZW51LmpzIiwianF1ZXJ5LnRvdWNoU3dpcGUubWluLmpzIiwibWFwLmpzIiwibWVudUFjY29yZGVvbi5qcyIsIm1vZGFsLmpzIiwib25lUGFnZVNjcm9sbC5qcyIsInBsYXllci5qcyIsInNsaWRlci5qcyIsInRhYnMuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQy9CQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQzNCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENDaEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQy9DQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0NoRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0NyRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtDOUpBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0MxR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1DTEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoibWFpbi5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gKCkge1xuY29uc3Qgb3Blbkl0ZW0gPSBpdGVtID0+IHtcbiAgY29uc3QgY29udGFpbmVyID0gaXRlbS5jbG9zZXN0KFwiLnRlYW1fX2l0ZW1cIik7XG4gIGNvbnN0IGNvbnRlbnRCbG9jayA9IGNvbnRhaW5lci5maW5kKFwiLnRlYW1fX2NvbnRlbnRcIik7XG4gIGNvbnN0IHRleHRCbG9jayA9IGNvbnRlbnRCbG9jay5maW5kKFwiLnRlYW1fX2NvbnRlbnQtYmxvY2tcIik7XG4gIGNvbnN0IHJlcUhlaWdodCA9IHRleHRCbG9jay5oZWlnaHQoKTtcblxuICBjb250YWluZXIuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xuICBjb250ZW50QmxvY2suaGVpZ2h0KHJlcUhlaWdodCk7XG59XG5cbmNvbnN0IGNsb3NlRXZlcnlJdGVtID0gY29udGFpbmVyID0+IHtcbiAgY29uc3QgaXRlbXMgPSBjb250YWluZXIuZmluZChcIi50ZWFtX19jb250ZW50XCIpXG4gIGNvbnN0IEl0ZW1Db250YWluZXIgPSBjb250YWluZXIuZmluZChcIi50ZWFtX19pdGVtXCIpO1xuXG4gIEl0ZW1Db250YWluZXIucmVtb3ZlQ2xhc3MoXCJhY3RpdmVcIik7XG4gIGl0ZW1zLmhlaWdodCgwKTtcbn07XG5cbiQoJy50ZWFtX190aXRsZScpLmNsaWNrKGUgPT4ge1xuICBjb25zdCAkdGhpcyA9ICQoZS5jdXJyZW50VGFyZ2V0KTtcbiAgY29uc3QgY29udGFpbmVyID0gJHRoaXMuY2xvc2VzdChcIi50ZWFtXCIpO1xuICBjb25zdCBlbGVtQ29udGFpbmVyID0gJHRoaXMuY2xvc2VzdChcIi50ZWFtX19pdGVtXCIpO1xuXG4gIGlmIChlbGVtQ29udGFpbmVyLmhhc0NsYXNzKFwiYWN0aXZlXCIpKSB7XG4gICAgY2xvc2VFdmVyeUl0ZW0oY29udGFpbmVyKTtcbiAgfSBlbHNlIHtcbiAgICBjbG9zZUV2ZXJ5SXRlbShjb250YWluZXIpO1xuICAgIG9wZW5JdGVtKCR0aGlzKTtcbiAgfVxufSk7XG59KSgpIiwiKGZ1bmN0aW9uICgpIHtcbmNvbnN0IGhhbWJ1cmdlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjaGFtYnVyZ2VyXCIpO1xuY29uc3QgZnVsbHNjcmVlbk1lbnUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmZ1bGxzY3JlZW4tbWVudVwiKTtcbmNvbnN0IGNsb3NlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5mdWxsc2NyZWVuLW1lbnVfX2Nsb3NlXCIpXG5jb25zdCBib2R5ID0gZG9jdW1lbnQuYm9keTtcbmNvbnN0IG1lbnVJdGVtID0gJChcIi5tZW51X19pdGVtXCIpO1xuXG5oYW1idXJnZXIuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGUgPT4ge1xuICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgZnVsbHNjcmVlbk1lbnUuY2xhc3NMaXN0LmFkZChcImFjdGl2ZVwiKTtcbiAgYm9keS5jbGFzc0xpc3QuYWRkKFwiYm9keS1hY3RpdmUtbWVudVwiKTtcbn0pXG5cbmNsb3NlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBlID0+IHtcbiAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gIGZ1bGxzY3JlZW5NZW51LmNsYXNzTGlzdC5yZW1vdmUoXCJhY3RpdmVcIik7XG4gIGJvZHkuY2xhc3NMaXN0LnJlbW92ZShcImJvZHktYWN0aXZlLW1lbnVcIik7XG59KVxuXG5tZW51SXRlbS5vbihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcbiAgaWYgKCQoZnVsbHNjcmVlbk1lbnUpLmhhc0NsYXNzKFwiYWN0aXZlXCIpKSB7XG4gICAgZnVsbHNjcmVlbk1lbnUuY2xhc3NMaXN0LnJlbW92ZShcImFjdGl2ZVwiKTtcbiAgICBib2R5LmNsYXNzTGlzdC5yZW1vdmUoXCJib2R5LWFjdGl2ZS1tZW51XCIpO1xuICB9XG59KVxufSkoKSIsIi8qIVxuICogQGZpbGVPdmVydmlldyBUb3VjaFN3aXBlIC0galF1ZXJ5IFBsdWdpblxuICogQHZlcnNpb24gMS42LjE4XG4gKlxuICogQGF1dGhvciBNYXR0IEJyeXNvbiBodHRwOi8vd3d3LmdpdGh1Yi5jb20vbWF0dGJyeXNvblxuICogQHNlZSBodHRwczovL2dpdGh1Yi5jb20vbWF0dGJyeXNvbi9Ub3VjaFN3aXBlLUpxdWVyeS1QbHVnaW5cbiAqIEBzZWUgaHR0cDovL2xhYnMucmFtcGludGVyYWN0aXZlLmNvLnVrL3RvdWNoU3dpcGUvXG4gKiBAc2VlIGh0dHA6Ly9wbHVnaW5zLmpxdWVyeS5jb20vcHJvamVjdC90b3VjaFN3aXBlXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IChjKSAyMDEwLTIwMTUgTWF0dCBCcnlzb25cbiAqIER1YWwgbGljZW5zZWQgdW5kZXIgdGhlIE1JVCBvciBHUEwgVmVyc2lvbiAyIGxpY2Vuc2VzLlxuICpcbiAqL1xuXG4hZnVuY3Rpb24oZmFjdG9yeSl7XCJmdW5jdGlvblwiPT10eXBlb2YgZGVmaW5lJiZkZWZpbmUuYW1kJiZkZWZpbmUuYW1kLmpRdWVyeT9kZWZpbmUoW1wianF1ZXJ5XCJdLGZhY3RvcnkpOmZhY3RvcnkoXCJ1bmRlZmluZWRcIiE9dHlwZW9mIG1vZHVsZSYmbW9kdWxlLmV4cG9ydHM/cmVxdWlyZShcImpxdWVyeVwiKTpqUXVlcnkpfShmdW5jdGlvbigkKXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiBpbml0KG9wdGlvbnMpe3JldHVybiFvcHRpb25zfHx2b2lkIDAhPT1vcHRpb25zLmFsbG93UGFnZVNjcm9sbHx8dm9pZCAwPT09b3B0aW9ucy5zd2lwZSYmdm9pZCAwPT09b3B0aW9ucy5zd2lwZVN0YXR1c3x8KG9wdGlvbnMuYWxsb3dQYWdlU2Nyb2xsPU5PTkUpLHZvaWQgMCE9PW9wdGlvbnMuY2xpY2smJnZvaWQgMD09PW9wdGlvbnMudGFwJiYob3B0aW9ucy50YXA9b3B0aW9ucy5jbGljayksb3B0aW9uc3x8KG9wdGlvbnM9e30pLG9wdGlvbnM9JC5leHRlbmQoe30sJC5mbi5zd2lwZS5kZWZhdWx0cyxvcHRpb25zKSx0aGlzLmVhY2goZnVuY3Rpb24oKXt2YXIgJHRoaXM9JCh0aGlzKSxwbHVnaW49JHRoaXMuZGF0YShQTFVHSU5fTlMpO3BsdWdpbnx8KHBsdWdpbj1uZXcgVG91Y2hTd2lwZSh0aGlzLG9wdGlvbnMpLCR0aGlzLmRhdGEoUExVR0lOX05TLHBsdWdpbikpfSl9ZnVuY3Rpb24gVG91Y2hTd2lwZShlbGVtZW50LG9wdGlvbnMpe2Z1bmN0aW9uIHRvdWNoU3RhcnQoanFFdmVudCl7aWYoIShnZXRUb3VjaEluUHJvZ3Jlc3MoKXx8JChqcUV2ZW50LnRhcmdldCkuY2xvc2VzdChvcHRpb25zLmV4Y2x1ZGVkRWxlbWVudHMsJGVsZW1lbnQpLmxlbmd0aD4wKSl7dmFyIGV2ZW50PWpxRXZlbnQub3JpZ2luYWxFdmVudD9qcUV2ZW50Lm9yaWdpbmFsRXZlbnQ6anFFdmVudDtpZighZXZlbnQucG9pbnRlclR5cGV8fFwibW91c2VcIiE9ZXZlbnQucG9pbnRlclR5cGV8fDAhPW9wdGlvbnMuZmFsbGJhY2tUb01vdXNlRXZlbnRzKXt2YXIgcmV0LHRvdWNoZXM9ZXZlbnQudG91Y2hlcyxldnQ9dG91Y2hlcz90b3VjaGVzWzBdOmV2ZW50O3JldHVybiBwaGFzZT1QSEFTRV9TVEFSVCx0b3VjaGVzP2ZpbmdlckNvdW50PXRvdWNoZXMubGVuZ3RoOm9wdGlvbnMucHJldmVudERlZmF1bHRFdmVudHMhPT0hMSYmanFFdmVudC5wcmV2ZW50RGVmYXVsdCgpLGRpc3RhbmNlPTAsZGlyZWN0aW9uPW51bGwsY3VycmVudERpcmVjdGlvbj1udWxsLHBpbmNoRGlyZWN0aW9uPW51bGwsZHVyYXRpb249MCxzdGFydFRvdWNoZXNEaXN0YW5jZT0wLGVuZFRvdWNoZXNEaXN0YW5jZT0wLHBpbmNoWm9vbT0xLHBpbmNoRGlzdGFuY2U9MCxtYXhpbXVtc01hcD1jcmVhdGVNYXhpbXVtc0RhdGEoKSxjYW5jZWxNdWx0aUZpbmdlclJlbGVhc2UoKSxjcmVhdGVGaW5nZXJEYXRhKDAsZXZ0KSwhdG91Y2hlc3x8ZmluZ2VyQ291bnQ9PT1vcHRpb25zLmZpbmdlcnN8fG9wdGlvbnMuZmluZ2Vycz09PUFMTF9GSU5HRVJTfHxoYXNQaW5jaGVzKCk/KHN0YXJ0VGltZT1nZXRUaW1lU3RhbXAoKSwyPT1maW5nZXJDb3VudCYmKGNyZWF0ZUZpbmdlckRhdGEoMSx0b3VjaGVzWzFdKSxzdGFydFRvdWNoZXNEaXN0YW5jZT1lbmRUb3VjaGVzRGlzdGFuY2U9Y2FsY3VsYXRlVG91Y2hlc0Rpc3RhbmNlKGZpbmdlckRhdGFbMF0uc3RhcnQsZmluZ2VyRGF0YVsxXS5zdGFydCkpLChvcHRpb25zLnN3aXBlU3RhdHVzfHxvcHRpb25zLnBpbmNoU3RhdHVzKSYmKHJldD10cmlnZ2VySGFuZGxlcihldmVudCxwaGFzZSkpKTpyZXQ9ITEscmV0PT09ITE/KHBoYXNlPVBIQVNFX0NBTkNFTCx0cmlnZ2VySGFuZGxlcihldmVudCxwaGFzZSkscmV0KToob3B0aW9ucy5ob2xkJiYoaG9sZFRpbWVvdXQ9c2V0VGltZW91dCgkLnByb3h5KGZ1bmN0aW9uKCl7JGVsZW1lbnQudHJpZ2dlcihcImhvbGRcIixbZXZlbnQudGFyZ2V0XSksb3B0aW9ucy5ob2xkJiYocmV0PW9wdGlvbnMuaG9sZC5jYWxsKCRlbGVtZW50LGV2ZW50LGV2ZW50LnRhcmdldCkpfSx0aGlzKSxvcHRpb25zLmxvbmdUYXBUaHJlc2hvbGQpKSxzZXRUb3VjaEluUHJvZ3Jlc3MoITApLG51bGwpfX19ZnVuY3Rpb24gdG91Y2hNb3ZlKGpxRXZlbnQpe3ZhciBldmVudD1qcUV2ZW50Lm9yaWdpbmFsRXZlbnQ/anFFdmVudC5vcmlnaW5hbEV2ZW50OmpxRXZlbnQ7aWYocGhhc2UhPT1QSEFTRV9FTkQmJnBoYXNlIT09UEhBU0VfQ0FOQ0VMJiYhaW5NdWx0aUZpbmdlclJlbGVhc2UoKSl7dmFyIHJldCx0b3VjaGVzPWV2ZW50LnRvdWNoZXMsZXZ0PXRvdWNoZXM/dG91Y2hlc1swXTpldmVudCxjdXJyZW50RmluZ2VyPXVwZGF0ZUZpbmdlckRhdGEoZXZ0KTtpZihlbmRUaW1lPWdldFRpbWVTdGFtcCgpLHRvdWNoZXMmJihmaW5nZXJDb3VudD10b3VjaGVzLmxlbmd0aCksb3B0aW9ucy5ob2xkJiZjbGVhclRpbWVvdXQoaG9sZFRpbWVvdXQpLHBoYXNlPVBIQVNFX01PVkUsMj09ZmluZ2VyQ291bnQmJigwPT1zdGFydFRvdWNoZXNEaXN0YW5jZT8oY3JlYXRlRmluZ2VyRGF0YSgxLHRvdWNoZXNbMV0pLHN0YXJ0VG91Y2hlc0Rpc3RhbmNlPWVuZFRvdWNoZXNEaXN0YW5jZT1jYWxjdWxhdGVUb3VjaGVzRGlzdGFuY2UoZmluZ2VyRGF0YVswXS5zdGFydCxmaW5nZXJEYXRhWzFdLnN0YXJ0KSk6KHVwZGF0ZUZpbmdlckRhdGEodG91Y2hlc1sxXSksZW5kVG91Y2hlc0Rpc3RhbmNlPWNhbGN1bGF0ZVRvdWNoZXNEaXN0YW5jZShmaW5nZXJEYXRhWzBdLmVuZCxmaW5nZXJEYXRhWzFdLmVuZCkscGluY2hEaXJlY3Rpb249Y2FsY3VsYXRlUGluY2hEaXJlY3Rpb24oZmluZ2VyRGF0YVswXS5lbmQsZmluZ2VyRGF0YVsxXS5lbmQpKSxwaW5jaFpvb209Y2FsY3VsYXRlUGluY2hab29tKHN0YXJ0VG91Y2hlc0Rpc3RhbmNlLGVuZFRvdWNoZXNEaXN0YW5jZSkscGluY2hEaXN0YW5jZT1NYXRoLmFicyhzdGFydFRvdWNoZXNEaXN0YW5jZS1lbmRUb3VjaGVzRGlzdGFuY2UpKSxmaW5nZXJDb3VudD09PW9wdGlvbnMuZmluZ2Vyc3x8b3B0aW9ucy5maW5nZXJzPT09QUxMX0ZJTkdFUlN8fCF0b3VjaGVzfHxoYXNQaW5jaGVzKCkpe2lmKGRpcmVjdGlvbj1jYWxjdWxhdGVEaXJlY3Rpb24oY3VycmVudEZpbmdlci5zdGFydCxjdXJyZW50RmluZ2VyLmVuZCksY3VycmVudERpcmVjdGlvbj1jYWxjdWxhdGVEaXJlY3Rpb24oY3VycmVudEZpbmdlci5sYXN0LGN1cnJlbnRGaW5nZXIuZW5kKSx2YWxpZGF0ZURlZmF1bHRFdmVudChqcUV2ZW50LGN1cnJlbnREaXJlY3Rpb24pLGRpc3RhbmNlPWNhbGN1bGF0ZURpc3RhbmNlKGN1cnJlbnRGaW5nZXIuc3RhcnQsY3VycmVudEZpbmdlci5lbmQpLGR1cmF0aW9uPWNhbGN1bGF0ZUR1cmF0aW9uKCksc2V0TWF4RGlzdGFuY2UoZGlyZWN0aW9uLGRpc3RhbmNlKSxyZXQ9dHJpZ2dlckhhbmRsZXIoZXZlbnQscGhhc2UpLCFvcHRpb25zLnRyaWdnZXJPblRvdWNoRW5kfHxvcHRpb25zLnRyaWdnZXJPblRvdWNoTGVhdmUpe3ZhciBpbkJvdW5kcz0hMDtpZihvcHRpb25zLnRyaWdnZXJPblRvdWNoTGVhdmUpe3ZhciBib3VuZHM9Z2V0Ym91bmRzKHRoaXMpO2luQm91bmRzPWlzSW5Cb3VuZHMoY3VycmVudEZpbmdlci5lbmQsYm91bmRzKX0hb3B0aW9ucy50cmlnZ2VyT25Ub3VjaEVuZCYmaW5Cb3VuZHM/cGhhc2U9Z2V0TmV4dFBoYXNlKFBIQVNFX01PVkUpOm9wdGlvbnMudHJpZ2dlck9uVG91Y2hMZWF2ZSYmIWluQm91bmRzJiYocGhhc2U9Z2V0TmV4dFBoYXNlKFBIQVNFX0VORCkpLHBoYXNlIT1QSEFTRV9DQU5DRUwmJnBoYXNlIT1QSEFTRV9FTkR8fHRyaWdnZXJIYW5kbGVyKGV2ZW50LHBoYXNlKX19ZWxzZSBwaGFzZT1QSEFTRV9DQU5DRUwsdHJpZ2dlckhhbmRsZXIoZXZlbnQscGhhc2UpO3JldD09PSExJiYocGhhc2U9UEhBU0VfQ0FOQ0VMLHRyaWdnZXJIYW5kbGVyKGV2ZW50LHBoYXNlKSl9fWZ1bmN0aW9uIHRvdWNoRW5kKGpxRXZlbnQpe3ZhciBldmVudD1qcUV2ZW50Lm9yaWdpbmFsRXZlbnQ/anFFdmVudC5vcmlnaW5hbEV2ZW50OmpxRXZlbnQsdG91Y2hlcz1ldmVudC50b3VjaGVzO2lmKHRvdWNoZXMpe2lmKHRvdWNoZXMubGVuZ3RoJiYhaW5NdWx0aUZpbmdlclJlbGVhc2UoKSlyZXR1cm4gc3RhcnRNdWx0aUZpbmdlclJlbGVhc2UoZXZlbnQpLCEwO2lmKHRvdWNoZXMubGVuZ3RoJiZpbk11bHRpRmluZ2VyUmVsZWFzZSgpKXJldHVybiEwfXJldHVybiBpbk11bHRpRmluZ2VyUmVsZWFzZSgpJiYoZmluZ2VyQ291bnQ9ZmluZ2VyQ291bnRBdFJlbGVhc2UpLGVuZFRpbWU9Z2V0VGltZVN0YW1wKCksZHVyYXRpb249Y2FsY3VsYXRlRHVyYXRpb24oKSxkaWRTd2lwZUJhY2tUb0NhbmNlbCgpfHwhdmFsaWRhdGVTd2lwZURpc3RhbmNlKCk/KHBoYXNlPVBIQVNFX0NBTkNFTCx0cmlnZ2VySGFuZGxlcihldmVudCxwaGFzZSkpOm9wdGlvbnMudHJpZ2dlck9uVG91Y2hFbmR8fG9wdGlvbnMudHJpZ2dlck9uVG91Y2hFbmQ9PT0hMSYmcGhhc2U9PT1QSEFTRV9NT1ZFPyhvcHRpb25zLnByZXZlbnREZWZhdWx0RXZlbnRzIT09ITEmJmpxRXZlbnQucHJldmVudERlZmF1bHQoKSxwaGFzZT1QSEFTRV9FTkQsdHJpZ2dlckhhbmRsZXIoZXZlbnQscGhhc2UpKTohb3B0aW9ucy50cmlnZ2VyT25Ub3VjaEVuZCYmaGFzVGFwKCk/KHBoYXNlPVBIQVNFX0VORCx0cmlnZ2VySGFuZGxlckZvckdlc3R1cmUoZXZlbnQscGhhc2UsVEFQKSk6cGhhc2U9PT1QSEFTRV9NT1ZFJiYocGhhc2U9UEhBU0VfQ0FOQ0VMLHRyaWdnZXJIYW5kbGVyKGV2ZW50LHBoYXNlKSksc2V0VG91Y2hJblByb2dyZXNzKCExKSxudWxsfWZ1bmN0aW9uIHRvdWNoQ2FuY2VsKCl7ZmluZ2VyQ291bnQ9MCxlbmRUaW1lPTAsc3RhcnRUaW1lPTAsc3RhcnRUb3VjaGVzRGlzdGFuY2U9MCxlbmRUb3VjaGVzRGlzdGFuY2U9MCxwaW5jaFpvb209MSxjYW5jZWxNdWx0aUZpbmdlclJlbGVhc2UoKSxzZXRUb3VjaEluUHJvZ3Jlc3MoITEpfWZ1bmN0aW9uIHRvdWNoTGVhdmUoanFFdmVudCl7dmFyIGV2ZW50PWpxRXZlbnQub3JpZ2luYWxFdmVudD9qcUV2ZW50Lm9yaWdpbmFsRXZlbnQ6anFFdmVudDtvcHRpb25zLnRyaWdnZXJPblRvdWNoTGVhdmUmJihwaGFzZT1nZXROZXh0UGhhc2UoUEhBU0VfRU5EKSx0cmlnZ2VySGFuZGxlcihldmVudCxwaGFzZSkpfWZ1bmN0aW9uIHJlbW92ZUxpc3RlbmVycygpeyRlbGVtZW50LnVuYmluZChTVEFSVF9FVix0b3VjaFN0YXJ0KSwkZWxlbWVudC51bmJpbmQoQ0FOQ0VMX0VWLHRvdWNoQ2FuY2VsKSwkZWxlbWVudC51bmJpbmQoTU9WRV9FVix0b3VjaE1vdmUpLCRlbGVtZW50LnVuYmluZChFTkRfRVYsdG91Y2hFbmQpLExFQVZFX0VWJiYkZWxlbWVudC51bmJpbmQoTEVBVkVfRVYsdG91Y2hMZWF2ZSksc2V0VG91Y2hJblByb2dyZXNzKCExKX1mdW5jdGlvbiBnZXROZXh0UGhhc2UoY3VycmVudFBoYXNlKXt2YXIgbmV4dFBoYXNlPWN1cnJlbnRQaGFzZSx2YWxpZFRpbWU9dmFsaWRhdGVTd2lwZVRpbWUoKSx2YWxpZERpc3RhbmNlPXZhbGlkYXRlU3dpcGVEaXN0YW5jZSgpLGRpZENhbmNlbD1kaWRTd2lwZUJhY2tUb0NhbmNlbCgpO3JldHVybiF2YWxpZFRpbWV8fGRpZENhbmNlbD9uZXh0UGhhc2U9UEhBU0VfQ0FOQ0VMOiF2YWxpZERpc3RhbmNlfHxjdXJyZW50UGhhc2UhPVBIQVNFX01PVkV8fG9wdGlvbnMudHJpZ2dlck9uVG91Y2hFbmQmJiFvcHRpb25zLnRyaWdnZXJPblRvdWNoTGVhdmU/IXZhbGlkRGlzdGFuY2UmJmN1cnJlbnRQaGFzZT09UEhBU0VfRU5EJiZvcHRpb25zLnRyaWdnZXJPblRvdWNoTGVhdmUmJihuZXh0UGhhc2U9UEhBU0VfQ0FOQ0VMKTpuZXh0UGhhc2U9UEhBU0VfRU5ELG5leHRQaGFzZX1mdW5jdGlvbiB0cmlnZ2VySGFuZGxlcihldmVudCxwaGFzZSl7dmFyIHJldCx0b3VjaGVzPWV2ZW50LnRvdWNoZXM7cmV0dXJuKGRpZFN3aXBlKCl8fGhhc1N3aXBlcygpKSYmKHJldD10cmlnZ2VySGFuZGxlckZvckdlc3R1cmUoZXZlbnQscGhhc2UsU1dJUEUpKSwoZGlkUGluY2goKXx8aGFzUGluY2hlcygpKSYmcmV0IT09ITEmJihyZXQ9dHJpZ2dlckhhbmRsZXJGb3JHZXN0dXJlKGV2ZW50LHBoYXNlLFBJTkNIKSksZGlkRG91YmxlVGFwKCkmJnJldCE9PSExP3JldD10cmlnZ2VySGFuZGxlckZvckdlc3R1cmUoZXZlbnQscGhhc2UsRE9VQkxFX1RBUCk6ZGlkTG9uZ1RhcCgpJiZyZXQhPT0hMT9yZXQ9dHJpZ2dlckhhbmRsZXJGb3JHZXN0dXJlKGV2ZW50LHBoYXNlLExPTkdfVEFQKTpkaWRUYXAoKSYmcmV0IT09ITEmJihyZXQ9dHJpZ2dlckhhbmRsZXJGb3JHZXN0dXJlKGV2ZW50LHBoYXNlLFRBUCkpLHBoYXNlPT09UEhBU0VfQ0FOQ0VMJiZ0b3VjaENhbmNlbChldmVudCkscGhhc2U9PT1QSEFTRV9FTkQmJih0b3VjaGVzP3RvdWNoZXMubGVuZ3RofHx0b3VjaENhbmNlbChldmVudCk6dG91Y2hDYW5jZWwoZXZlbnQpKSxyZXR9ZnVuY3Rpb24gdHJpZ2dlckhhbmRsZXJGb3JHZXN0dXJlKGV2ZW50LHBoYXNlLGdlc3R1cmUpe3ZhciByZXQ7aWYoZ2VzdHVyZT09U1dJUEUpe2lmKCRlbGVtZW50LnRyaWdnZXIoXCJzd2lwZVN0YXR1c1wiLFtwaGFzZSxkaXJlY3Rpb258fG51bGwsZGlzdGFuY2V8fDAsZHVyYXRpb258fDAsZmluZ2VyQ291bnQsZmluZ2VyRGF0YSxjdXJyZW50RGlyZWN0aW9uXSksb3B0aW9ucy5zd2lwZVN0YXR1cyYmKHJldD1vcHRpb25zLnN3aXBlU3RhdHVzLmNhbGwoJGVsZW1lbnQsZXZlbnQscGhhc2UsZGlyZWN0aW9ufHxudWxsLGRpc3RhbmNlfHwwLGR1cmF0aW9ufHwwLGZpbmdlckNvdW50LGZpbmdlckRhdGEsY3VycmVudERpcmVjdGlvbikscmV0PT09ITEpKXJldHVybiExO2lmKHBoYXNlPT1QSEFTRV9FTkQmJnZhbGlkYXRlU3dpcGUoKSl7aWYoY2xlYXJUaW1lb3V0KHNpbmdsZVRhcFRpbWVvdXQpLGNsZWFyVGltZW91dChob2xkVGltZW91dCksJGVsZW1lbnQudHJpZ2dlcihcInN3aXBlXCIsW2RpcmVjdGlvbixkaXN0YW5jZSxkdXJhdGlvbixmaW5nZXJDb3VudCxmaW5nZXJEYXRhLGN1cnJlbnREaXJlY3Rpb25dKSxvcHRpb25zLnN3aXBlJiYocmV0PW9wdGlvbnMuc3dpcGUuY2FsbCgkZWxlbWVudCxldmVudCxkaXJlY3Rpb24sZGlzdGFuY2UsZHVyYXRpb24sZmluZ2VyQ291bnQsZmluZ2VyRGF0YSxjdXJyZW50RGlyZWN0aW9uKSxyZXQ9PT0hMSkpcmV0dXJuITE7c3dpdGNoKGRpcmVjdGlvbil7Y2FzZSBMRUZUOiRlbGVtZW50LnRyaWdnZXIoXCJzd2lwZUxlZnRcIixbZGlyZWN0aW9uLGRpc3RhbmNlLGR1cmF0aW9uLGZpbmdlckNvdW50LGZpbmdlckRhdGEsY3VycmVudERpcmVjdGlvbl0pLG9wdGlvbnMuc3dpcGVMZWZ0JiYocmV0PW9wdGlvbnMuc3dpcGVMZWZ0LmNhbGwoJGVsZW1lbnQsZXZlbnQsZGlyZWN0aW9uLGRpc3RhbmNlLGR1cmF0aW9uLGZpbmdlckNvdW50LGZpbmdlckRhdGEsY3VycmVudERpcmVjdGlvbikpO2JyZWFrO2Nhc2UgUklHSFQ6JGVsZW1lbnQudHJpZ2dlcihcInN3aXBlUmlnaHRcIixbZGlyZWN0aW9uLGRpc3RhbmNlLGR1cmF0aW9uLGZpbmdlckNvdW50LGZpbmdlckRhdGEsY3VycmVudERpcmVjdGlvbl0pLG9wdGlvbnMuc3dpcGVSaWdodCYmKHJldD1vcHRpb25zLnN3aXBlUmlnaHQuY2FsbCgkZWxlbWVudCxldmVudCxkaXJlY3Rpb24sZGlzdGFuY2UsZHVyYXRpb24sZmluZ2VyQ291bnQsZmluZ2VyRGF0YSxjdXJyZW50RGlyZWN0aW9uKSk7YnJlYWs7Y2FzZSBVUDokZWxlbWVudC50cmlnZ2VyKFwic3dpcGVVcFwiLFtkaXJlY3Rpb24sZGlzdGFuY2UsZHVyYXRpb24sZmluZ2VyQ291bnQsZmluZ2VyRGF0YSxjdXJyZW50RGlyZWN0aW9uXSksb3B0aW9ucy5zd2lwZVVwJiYocmV0PW9wdGlvbnMuc3dpcGVVcC5jYWxsKCRlbGVtZW50LGV2ZW50LGRpcmVjdGlvbixkaXN0YW5jZSxkdXJhdGlvbixmaW5nZXJDb3VudCxmaW5nZXJEYXRhLGN1cnJlbnREaXJlY3Rpb24pKTticmVhaztjYXNlIERPV046JGVsZW1lbnQudHJpZ2dlcihcInN3aXBlRG93blwiLFtkaXJlY3Rpb24sZGlzdGFuY2UsZHVyYXRpb24sZmluZ2VyQ291bnQsZmluZ2VyRGF0YSxjdXJyZW50RGlyZWN0aW9uXSksb3B0aW9ucy5zd2lwZURvd24mJihyZXQ9b3B0aW9ucy5zd2lwZURvd24uY2FsbCgkZWxlbWVudCxldmVudCxkaXJlY3Rpb24sZGlzdGFuY2UsZHVyYXRpb24sZmluZ2VyQ291bnQsZmluZ2VyRGF0YSxjdXJyZW50RGlyZWN0aW9uKSl9fX1pZihnZXN0dXJlPT1QSU5DSCl7aWYoJGVsZW1lbnQudHJpZ2dlcihcInBpbmNoU3RhdHVzXCIsW3BoYXNlLHBpbmNoRGlyZWN0aW9ufHxudWxsLHBpbmNoRGlzdGFuY2V8fDAsZHVyYXRpb258fDAsZmluZ2VyQ291bnQscGluY2hab29tLGZpbmdlckRhdGFdKSxvcHRpb25zLnBpbmNoU3RhdHVzJiYocmV0PW9wdGlvbnMucGluY2hTdGF0dXMuY2FsbCgkZWxlbWVudCxldmVudCxwaGFzZSxwaW5jaERpcmVjdGlvbnx8bnVsbCxwaW5jaERpc3RhbmNlfHwwLGR1cmF0aW9ufHwwLGZpbmdlckNvdW50LHBpbmNoWm9vbSxmaW5nZXJEYXRhKSxyZXQ9PT0hMSkpcmV0dXJuITE7aWYocGhhc2U9PVBIQVNFX0VORCYmdmFsaWRhdGVQaW5jaCgpKXN3aXRjaChwaW5jaERpcmVjdGlvbil7Y2FzZSBJTjokZWxlbWVudC50cmlnZ2VyKFwicGluY2hJblwiLFtwaW5jaERpcmVjdGlvbnx8bnVsbCxwaW5jaERpc3RhbmNlfHwwLGR1cmF0aW9ufHwwLGZpbmdlckNvdW50LHBpbmNoWm9vbSxmaW5nZXJEYXRhXSksb3B0aW9ucy5waW5jaEluJiYocmV0PW9wdGlvbnMucGluY2hJbi5jYWxsKCRlbGVtZW50LGV2ZW50LHBpbmNoRGlyZWN0aW9ufHxudWxsLHBpbmNoRGlzdGFuY2V8fDAsZHVyYXRpb258fDAsZmluZ2VyQ291bnQscGluY2hab29tLGZpbmdlckRhdGEpKTticmVhaztjYXNlIE9VVDokZWxlbWVudC50cmlnZ2VyKFwicGluY2hPdXRcIixbcGluY2hEaXJlY3Rpb258fG51bGwscGluY2hEaXN0YW5jZXx8MCxkdXJhdGlvbnx8MCxmaW5nZXJDb3VudCxwaW5jaFpvb20sZmluZ2VyRGF0YV0pLG9wdGlvbnMucGluY2hPdXQmJihyZXQ9b3B0aW9ucy5waW5jaE91dC5jYWxsKCRlbGVtZW50LGV2ZW50LHBpbmNoRGlyZWN0aW9ufHxudWxsLHBpbmNoRGlzdGFuY2V8fDAsZHVyYXRpb258fDAsZmluZ2VyQ291bnQscGluY2hab29tLGZpbmdlckRhdGEpKX19cmV0dXJuIGdlc3R1cmU9PVRBUD9waGFzZSE9PVBIQVNFX0NBTkNFTCYmcGhhc2UhPT1QSEFTRV9FTkR8fChjbGVhclRpbWVvdXQoc2luZ2xlVGFwVGltZW91dCksY2xlYXJUaW1lb3V0KGhvbGRUaW1lb3V0KSxoYXNEb3VibGVUYXAoKSYmIWluRG91YmxlVGFwKCk/KGRvdWJsZVRhcFN0YXJ0VGltZT1nZXRUaW1lU3RhbXAoKSxzaW5nbGVUYXBUaW1lb3V0PXNldFRpbWVvdXQoJC5wcm94eShmdW5jdGlvbigpe2RvdWJsZVRhcFN0YXJ0VGltZT1udWxsLCRlbGVtZW50LnRyaWdnZXIoXCJ0YXBcIixbZXZlbnQudGFyZ2V0XSksb3B0aW9ucy50YXAmJihyZXQ9b3B0aW9ucy50YXAuY2FsbCgkZWxlbWVudCxldmVudCxldmVudC50YXJnZXQpKX0sdGhpcyksb3B0aW9ucy5kb3VibGVUYXBUaHJlc2hvbGQpKTooZG91YmxlVGFwU3RhcnRUaW1lPW51bGwsJGVsZW1lbnQudHJpZ2dlcihcInRhcFwiLFtldmVudC50YXJnZXRdKSxvcHRpb25zLnRhcCYmKHJldD1vcHRpb25zLnRhcC5jYWxsKCRlbGVtZW50LGV2ZW50LGV2ZW50LnRhcmdldCkpKSk6Z2VzdHVyZT09RE9VQkxFX1RBUD9waGFzZSE9PVBIQVNFX0NBTkNFTCYmcGhhc2UhPT1QSEFTRV9FTkR8fChjbGVhclRpbWVvdXQoc2luZ2xlVGFwVGltZW91dCksY2xlYXJUaW1lb3V0KGhvbGRUaW1lb3V0KSxkb3VibGVUYXBTdGFydFRpbWU9bnVsbCwkZWxlbWVudC50cmlnZ2VyKFwiZG91YmxldGFwXCIsW2V2ZW50LnRhcmdldF0pLG9wdGlvbnMuZG91YmxlVGFwJiYocmV0PW9wdGlvbnMuZG91YmxlVGFwLmNhbGwoJGVsZW1lbnQsZXZlbnQsZXZlbnQudGFyZ2V0KSkpOmdlc3R1cmU9PUxPTkdfVEFQJiYocGhhc2UhPT1QSEFTRV9DQU5DRUwmJnBoYXNlIT09UEhBU0VfRU5EfHwoY2xlYXJUaW1lb3V0KHNpbmdsZVRhcFRpbWVvdXQpLGRvdWJsZVRhcFN0YXJ0VGltZT1udWxsLCRlbGVtZW50LnRyaWdnZXIoXCJsb25ndGFwXCIsW2V2ZW50LnRhcmdldF0pLG9wdGlvbnMubG9uZ1RhcCYmKHJldD1vcHRpb25zLmxvbmdUYXAuY2FsbCgkZWxlbWVudCxldmVudCxldmVudC50YXJnZXQpKSkpLHJldH1mdW5jdGlvbiB2YWxpZGF0ZVN3aXBlRGlzdGFuY2UoKXt2YXIgdmFsaWQ9ITA7cmV0dXJuIG51bGwhPT1vcHRpb25zLnRocmVzaG9sZCYmKHZhbGlkPWRpc3RhbmNlPj1vcHRpb25zLnRocmVzaG9sZCksdmFsaWR9ZnVuY3Rpb24gZGlkU3dpcGVCYWNrVG9DYW5jZWwoKXt2YXIgY2FuY2VsbGVkPSExO3JldHVybiBudWxsIT09b3B0aW9ucy5jYW5jZWxUaHJlc2hvbGQmJm51bGwhPT1kaXJlY3Rpb24mJihjYW5jZWxsZWQ9Z2V0TWF4RGlzdGFuY2UoZGlyZWN0aW9uKS1kaXN0YW5jZT49b3B0aW9ucy5jYW5jZWxUaHJlc2hvbGQpLGNhbmNlbGxlZH1mdW5jdGlvbiB2YWxpZGF0ZVBpbmNoRGlzdGFuY2UoKXtyZXR1cm4gbnVsbD09PW9wdGlvbnMucGluY2hUaHJlc2hvbGR8fHBpbmNoRGlzdGFuY2U+PW9wdGlvbnMucGluY2hUaHJlc2hvbGR9ZnVuY3Rpb24gdmFsaWRhdGVTd2lwZVRpbWUoKXt2YXIgcmVzdWx0O3JldHVybiByZXN1bHQ9IW9wdGlvbnMubWF4VGltZVRocmVzaG9sZHx8IShkdXJhdGlvbj49b3B0aW9ucy5tYXhUaW1lVGhyZXNob2xkKX1mdW5jdGlvbiB2YWxpZGF0ZURlZmF1bHRFdmVudChqcUV2ZW50LGRpcmVjdGlvbil7aWYob3B0aW9ucy5wcmV2ZW50RGVmYXVsdEV2ZW50cyE9PSExKWlmKG9wdGlvbnMuYWxsb3dQYWdlU2Nyb2xsPT09Tk9ORSlqcUV2ZW50LnByZXZlbnREZWZhdWx0KCk7ZWxzZXt2YXIgYXV0bz1vcHRpb25zLmFsbG93UGFnZVNjcm9sbD09PUFVVE87c3dpdGNoKGRpcmVjdGlvbil7Y2FzZSBMRUZUOihvcHRpb25zLnN3aXBlTGVmdCYmYXV0b3x8IWF1dG8mJm9wdGlvbnMuYWxsb3dQYWdlU2Nyb2xsIT1IT1JJWk9OVEFMKSYmanFFdmVudC5wcmV2ZW50RGVmYXVsdCgpO2JyZWFrO2Nhc2UgUklHSFQ6KG9wdGlvbnMuc3dpcGVSaWdodCYmYXV0b3x8IWF1dG8mJm9wdGlvbnMuYWxsb3dQYWdlU2Nyb2xsIT1IT1JJWk9OVEFMKSYmanFFdmVudC5wcmV2ZW50RGVmYXVsdCgpO2JyZWFrO2Nhc2UgVVA6KG9wdGlvbnMuc3dpcGVVcCYmYXV0b3x8IWF1dG8mJm9wdGlvbnMuYWxsb3dQYWdlU2Nyb2xsIT1WRVJUSUNBTCkmJmpxRXZlbnQucHJldmVudERlZmF1bHQoKTticmVhaztjYXNlIERPV046KG9wdGlvbnMuc3dpcGVEb3duJiZhdXRvfHwhYXV0byYmb3B0aW9ucy5hbGxvd1BhZ2VTY3JvbGwhPVZFUlRJQ0FMKSYmanFFdmVudC5wcmV2ZW50RGVmYXVsdCgpO2JyZWFrO2Nhc2UgTk9ORTp9fX1mdW5jdGlvbiB2YWxpZGF0ZVBpbmNoKCl7dmFyIGhhc0NvcnJlY3RGaW5nZXJDb3VudD12YWxpZGF0ZUZpbmdlcnMoKSxoYXNFbmRQb2ludD12YWxpZGF0ZUVuZFBvaW50KCksaGFzQ29ycmVjdERpc3RhbmNlPXZhbGlkYXRlUGluY2hEaXN0YW5jZSgpO3JldHVybiBoYXNDb3JyZWN0RmluZ2VyQ291bnQmJmhhc0VuZFBvaW50JiZoYXNDb3JyZWN0RGlzdGFuY2V9ZnVuY3Rpb24gaGFzUGluY2hlcygpe3JldHVybiEhKG9wdGlvbnMucGluY2hTdGF0dXN8fG9wdGlvbnMucGluY2hJbnx8b3B0aW9ucy5waW5jaE91dCl9ZnVuY3Rpb24gZGlkUGluY2goKXtyZXR1cm4hKCF2YWxpZGF0ZVBpbmNoKCl8fCFoYXNQaW5jaGVzKCkpfWZ1bmN0aW9uIHZhbGlkYXRlU3dpcGUoKXt2YXIgaGFzVmFsaWRUaW1lPXZhbGlkYXRlU3dpcGVUaW1lKCksaGFzVmFsaWREaXN0YW5jZT12YWxpZGF0ZVN3aXBlRGlzdGFuY2UoKSxoYXNDb3JyZWN0RmluZ2VyQ291bnQ9dmFsaWRhdGVGaW5nZXJzKCksaGFzRW5kUG9pbnQ9dmFsaWRhdGVFbmRQb2ludCgpLGRpZENhbmNlbD1kaWRTd2lwZUJhY2tUb0NhbmNlbCgpLHZhbGlkPSFkaWRDYW5jZWwmJmhhc0VuZFBvaW50JiZoYXNDb3JyZWN0RmluZ2VyQ291bnQmJmhhc1ZhbGlkRGlzdGFuY2UmJmhhc1ZhbGlkVGltZTtyZXR1cm4gdmFsaWR9ZnVuY3Rpb24gaGFzU3dpcGVzKCl7cmV0dXJuISEob3B0aW9ucy5zd2lwZXx8b3B0aW9ucy5zd2lwZVN0YXR1c3x8b3B0aW9ucy5zd2lwZUxlZnR8fG9wdGlvbnMuc3dpcGVSaWdodHx8b3B0aW9ucy5zd2lwZVVwfHxvcHRpb25zLnN3aXBlRG93bil9ZnVuY3Rpb24gZGlkU3dpcGUoKXtyZXR1cm4hKCF2YWxpZGF0ZVN3aXBlKCl8fCFoYXNTd2lwZXMoKSl9ZnVuY3Rpb24gdmFsaWRhdGVGaW5nZXJzKCl7cmV0dXJuIGZpbmdlckNvdW50PT09b3B0aW9ucy5maW5nZXJzfHxvcHRpb25zLmZpbmdlcnM9PT1BTExfRklOR0VSU3x8IVNVUFBPUlRTX1RPVUNIfWZ1bmN0aW9uIHZhbGlkYXRlRW5kUG9pbnQoKXtyZXR1cm4gMCE9PWZpbmdlckRhdGFbMF0uZW5kLnh9ZnVuY3Rpb24gaGFzVGFwKCl7cmV0dXJuISFvcHRpb25zLnRhcH1mdW5jdGlvbiBoYXNEb3VibGVUYXAoKXtyZXR1cm4hIW9wdGlvbnMuZG91YmxlVGFwfWZ1bmN0aW9uIGhhc0xvbmdUYXAoKXtyZXR1cm4hIW9wdGlvbnMubG9uZ1RhcH1mdW5jdGlvbiB2YWxpZGF0ZURvdWJsZVRhcCgpe2lmKG51bGw9PWRvdWJsZVRhcFN0YXJ0VGltZSlyZXR1cm4hMTt2YXIgbm93PWdldFRpbWVTdGFtcCgpO3JldHVybiBoYXNEb3VibGVUYXAoKSYmbm93LWRvdWJsZVRhcFN0YXJ0VGltZTw9b3B0aW9ucy5kb3VibGVUYXBUaHJlc2hvbGR9ZnVuY3Rpb24gaW5Eb3VibGVUYXAoKXtyZXR1cm4gdmFsaWRhdGVEb3VibGVUYXAoKX1mdW5jdGlvbiB2YWxpZGF0ZVRhcCgpe3JldHVybigxPT09ZmluZ2VyQ291bnR8fCFTVVBQT1JUU19UT1VDSCkmJihpc05hTihkaXN0YW5jZSl8fGRpc3RhbmNlPG9wdGlvbnMudGhyZXNob2xkKX1mdW5jdGlvbiB2YWxpZGF0ZUxvbmdUYXAoKXtyZXR1cm4gZHVyYXRpb24+b3B0aW9ucy5sb25nVGFwVGhyZXNob2xkJiZkaXN0YW5jZTxET1VCTEVfVEFQX1RIUkVTSE9MRH1mdW5jdGlvbiBkaWRUYXAoKXtyZXR1cm4hKCF2YWxpZGF0ZVRhcCgpfHwhaGFzVGFwKCkpfWZ1bmN0aW9uIGRpZERvdWJsZVRhcCgpe3JldHVybiEoIXZhbGlkYXRlRG91YmxlVGFwKCl8fCFoYXNEb3VibGVUYXAoKSl9ZnVuY3Rpb24gZGlkTG9uZ1RhcCgpe3JldHVybiEoIXZhbGlkYXRlTG9uZ1RhcCgpfHwhaGFzTG9uZ1RhcCgpKX1mdW5jdGlvbiBzdGFydE11bHRpRmluZ2VyUmVsZWFzZShldmVudCl7cHJldmlvdXNUb3VjaEVuZFRpbWU9Z2V0VGltZVN0YW1wKCksZmluZ2VyQ291bnRBdFJlbGVhc2U9ZXZlbnQudG91Y2hlcy5sZW5ndGgrMX1mdW5jdGlvbiBjYW5jZWxNdWx0aUZpbmdlclJlbGVhc2UoKXtwcmV2aW91c1RvdWNoRW5kVGltZT0wLGZpbmdlckNvdW50QXRSZWxlYXNlPTB9ZnVuY3Rpb24gaW5NdWx0aUZpbmdlclJlbGVhc2UoKXt2YXIgd2l0aGluVGhyZXNob2xkPSExO2lmKHByZXZpb3VzVG91Y2hFbmRUaW1lKXt2YXIgZGlmZj1nZXRUaW1lU3RhbXAoKS1wcmV2aW91c1RvdWNoRW5kVGltZTtkaWZmPD1vcHRpb25zLmZpbmdlclJlbGVhc2VUaHJlc2hvbGQmJih3aXRoaW5UaHJlc2hvbGQ9ITApfXJldHVybiB3aXRoaW5UaHJlc2hvbGR9ZnVuY3Rpb24gZ2V0VG91Y2hJblByb2dyZXNzKCl7cmV0dXJuISgkZWxlbWVudC5kYXRhKFBMVUdJTl9OUytcIl9pbnRvdWNoXCIpIT09ITApfWZ1bmN0aW9uIHNldFRvdWNoSW5Qcm9ncmVzcyh2YWwpeyRlbGVtZW50JiYodmFsPT09ITA/KCRlbGVtZW50LmJpbmQoTU9WRV9FVix0b3VjaE1vdmUpLCRlbGVtZW50LmJpbmQoRU5EX0VWLHRvdWNoRW5kKSxMRUFWRV9FViYmJGVsZW1lbnQuYmluZChMRUFWRV9FVix0b3VjaExlYXZlKSk6KCRlbGVtZW50LnVuYmluZChNT1ZFX0VWLHRvdWNoTW92ZSwhMSksJGVsZW1lbnQudW5iaW5kKEVORF9FVix0b3VjaEVuZCwhMSksTEVBVkVfRVYmJiRlbGVtZW50LnVuYmluZChMRUFWRV9FVix0b3VjaExlYXZlLCExKSksJGVsZW1lbnQuZGF0YShQTFVHSU5fTlMrXCJfaW50b3VjaFwiLHZhbD09PSEwKSl9ZnVuY3Rpb24gY3JlYXRlRmluZ2VyRGF0YShpZCxldnQpe3ZhciBmPXtzdGFydDp7eDowLHk6MH0sbGFzdDp7eDowLHk6MH0sZW5kOnt4OjAseTowfX07cmV0dXJuIGYuc3RhcnQueD1mLmxhc3QueD1mLmVuZC54PWV2dC5wYWdlWHx8ZXZ0LmNsaWVudFgsZi5zdGFydC55PWYubGFzdC55PWYuZW5kLnk9ZXZ0LnBhZ2VZfHxldnQuY2xpZW50WSxmaW5nZXJEYXRhW2lkXT1mLGZ9ZnVuY3Rpb24gdXBkYXRlRmluZ2VyRGF0YShldnQpe3ZhciBpZD12b2lkIDAhPT1ldnQuaWRlbnRpZmllcj9ldnQuaWRlbnRpZmllcjowLGY9Z2V0RmluZ2VyRGF0YShpZCk7cmV0dXJuIG51bGw9PT1mJiYoZj1jcmVhdGVGaW5nZXJEYXRhKGlkLGV2dCkpLGYubGFzdC54PWYuZW5kLngsZi5sYXN0Lnk9Zi5lbmQueSxmLmVuZC54PWV2dC5wYWdlWHx8ZXZ0LmNsaWVudFgsZi5lbmQueT1ldnQucGFnZVl8fGV2dC5jbGllbnRZLGZ9ZnVuY3Rpb24gZ2V0RmluZ2VyRGF0YShpZCl7cmV0dXJuIGZpbmdlckRhdGFbaWRdfHxudWxsfWZ1bmN0aW9uIHNldE1heERpc3RhbmNlKGRpcmVjdGlvbixkaXN0YW5jZSl7ZGlyZWN0aW9uIT1OT05FJiYoZGlzdGFuY2U9TWF0aC5tYXgoZGlzdGFuY2UsZ2V0TWF4RGlzdGFuY2UoZGlyZWN0aW9uKSksbWF4aW11bXNNYXBbZGlyZWN0aW9uXS5kaXN0YW5jZT1kaXN0YW5jZSl9ZnVuY3Rpb24gZ2V0TWF4RGlzdGFuY2UoZGlyZWN0aW9uKXtpZihtYXhpbXVtc01hcFtkaXJlY3Rpb25dKXJldHVybiBtYXhpbXVtc01hcFtkaXJlY3Rpb25dLmRpc3RhbmNlfWZ1bmN0aW9uIGNyZWF0ZU1heGltdW1zRGF0YSgpe3ZhciBtYXhEYXRhPXt9O3JldHVybiBtYXhEYXRhW0xFRlRdPWNyZWF0ZU1heGltdW1WTyhMRUZUKSxtYXhEYXRhW1JJR0hUXT1jcmVhdGVNYXhpbXVtVk8oUklHSFQpLG1heERhdGFbVVBdPWNyZWF0ZU1heGltdW1WTyhVUCksbWF4RGF0YVtET1dOXT1jcmVhdGVNYXhpbXVtVk8oRE9XTiksbWF4RGF0YX1mdW5jdGlvbiBjcmVhdGVNYXhpbXVtVk8oZGlyKXtyZXR1cm57ZGlyZWN0aW9uOmRpcixkaXN0YW5jZTowfX1mdW5jdGlvbiBjYWxjdWxhdGVEdXJhdGlvbigpe3JldHVybiBlbmRUaW1lLXN0YXJ0VGltZX1mdW5jdGlvbiBjYWxjdWxhdGVUb3VjaGVzRGlzdGFuY2Uoc3RhcnRQb2ludCxlbmRQb2ludCl7dmFyIGRpZmZYPU1hdGguYWJzKHN0YXJ0UG9pbnQueC1lbmRQb2ludC54KSxkaWZmWT1NYXRoLmFicyhzdGFydFBvaW50LnktZW5kUG9pbnQueSk7cmV0dXJuIE1hdGgucm91bmQoTWF0aC5zcXJ0KGRpZmZYKmRpZmZYK2RpZmZZKmRpZmZZKSl9ZnVuY3Rpb24gY2FsY3VsYXRlUGluY2hab29tKHN0YXJ0RGlzdGFuY2UsZW5kRGlzdGFuY2Upe3ZhciBwZXJjZW50PWVuZERpc3RhbmNlL3N0YXJ0RGlzdGFuY2UqMTtyZXR1cm4gcGVyY2VudC50b0ZpeGVkKDIpfWZ1bmN0aW9uIGNhbGN1bGF0ZVBpbmNoRGlyZWN0aW9uKCl7cmV0dXJuIHBpbmNoWm9vbTwxP09VVDpJTn1mdW5jdGlvbiBjYWxjdWxhdGVEaXN0YW5jZShzdGFydFBvaW50LGVuZFBvaW50KXtyZXR1cm4gTWF0aC5yb3VuZChNYXRoLnNxcnQoTWF0aC5wb3coZW5kUG9pbnQueC1zdGFydFBvaW50LngsMikrTWF0aC5wb3coZW5kUG9pbnQueS1zdGFydFBvaW50LnksMikpKX1mdW5jdGlvbiBjYWxjdWxhdGVBbmdsZShzdGFydFBvaW50LGVuZFBvaW50KXt2YXIgeD1zdGFydFBvaW50LngtZW5kUG9pbnQueCx5PWVuZFBvaW50Lnktc3RhcnRQb2ludC55LHI9TWF0aC5hdGFuMih5LHgpLGFuZ2xlPU1hdGgucm91bmQoMTgwKnIvTWF0aC5QSSk7cmV0dXJuIGFuZ2xlPDAmJihhbmdsZT0zNjAtTWF0aC5hYnMoYW5nbGUpKSxhbmdsZX1mdW5jdGlvbiBjYWxjdWxhdGVEaXJlY3Rpb24oc3RhcnRQb2ludCxlbmRQb2ludCl7aWYoY29tcGFyZVBvaW50cyhzdGFydFBvaW50LGVuZFBvaW50KSlyZXR1cm4gTk9ORTt2YXIgYW5nbGU9Y2FsY3VsYXRlQW5nbGUoc3RhcnRQb2ludCxlbmRQb2ludCk7cmV0dXJuIGFuZ2xlPD00NSYmYW5nbGU+PTA/TEVGVDphbmdsZTw9MzYwJiZhbmdsZT49MzE1P0xFRlQ6YW5nbGU+PTEzNSYmYW5nbGU8PTIyNT9SSUdIVDphbmdsZT40NSYmYW5nbGU8MTM1P0RPV046VVB9ZnVuY3Rpb24gZ2V0VGltZVN0YW1wKCl7dmFyIG5vdz1uZXcgRGF0ZTtyZXR1cm4gbm93LmdldFRpbWUoKX1mdW5jdGlvbiBnZXRib3VuZHMoZWwpe2VsPSQoZWwpO3ZhciBvZmZzZXQ9ZWwub2Zmc2V0KCksYm91bmRzPXtsZWZ0Om9mZnNldC5sZWZ0LHJpZ2h0Om9mZnNldC5sZWZ0K2VsLm91dGVyV2lkdGgoKSx0b3A6b2Zmc2V0LnRvcCxib3R0b206b2Zmc2V0LnRvcCtlbC5vdXRlckhlaWdodCgpfTtyZXR1cm4gYm91bmRzfWZ1bmN0aW9uIGlzSW5Cb3VuZHMocG9pbnQsYm91bmRzKXtyZXR1cm4gcG9pbnQueD5ib3VuZHMubGVmdCYmcG9pbnQueDxib3VuZHMucmlnaHQmJnBvaW50Lnk+Ym91bmRzLnRvcCYmcG9pbnQueTxib3VuZHMuYm90dG9tfWZ1bmN0aW9uIGNvbXBhcmVQb2ludHMocG9pbnRBLHBvaW50Qil7cmV0dXJuIHBvaW50QS54PT1wb2ludEIueCYmcG9pbnRBLnk9PXBvaW50Qi55fXZhciBvcHRpb25zPSQuZXh0ZW5kKHt9LG9wdGlvbnMpLHVzZVRvdWNoRXZlbnRzPVNVUFBPUlRTX1RPVUNIfHxTVVBQT1JUU19QT0lOVEVSfHwhb3B0aW9ucy5mYWxsYmFja1RvTW91c2VFdmVudHMsU1RBUlRfRVY9dXNlVG91Y2hFdmVudHM/U1VQUE9SVFNfUE9JTlRFUj9TVVBQT1JUU19QT0lOVEVSX0lFMTA/XCJNU1BvaW50ZXJEb3duXCI6XCJwb2ludGVyZG93blwiOlwidG91Y2hzdGFydFwiOlwibW91c2Vkb3duXCIsTU9WRV9FVj11c2VUb3VjaEV2ZW50cz9TVVBQT1JUU19QT0lOVEVSP1NVUFBPUlRTX1BPSU5URVJfSUUxMD9cIk1TUG9pbnRlck1vdmVcIjpcInBvaW50ZXJtb3ZlXCI6XCJ0b3VjaG1vdmVcIjpcIm1vdXNlbW92ZVwiLEVORF9FVj11c2VUb3VjaEV2ZW50cz9TVVBQT1JUU19QT0lOVEVSP1NVUFBPUlRTX1BPSU5URVJfSUUxMD9cIk1TUG9pbnRlclVwXCI6XCJwb2ludGVydXBcIjpcInRvdWNoZW5kXCI6XCJtb3VzZXVwXCIsTEVBVkVfRVY9dXNlVG91Y2hFdmVudHM/U1VQUE9SVFNfUE9JTlRFUj9cIm1vdXNlbGVhdmVcIjpudWxsOlwibW91c2VsZWF2ZVwiLENBTkNFTF9FVj1TVVBQT1JUU19QT0lOVEVSP1NVUFBPUlRTX1BPSU5URVJfSUUxMD9cIk1TUG9pbnRlckNhbmNlbFwiOlwicG9pbnRlcmNhbmNlbFwiOlwidG91Y2hjYW5jZWxcIixkaXN0YW5jZT0wLGRpcmVjdGlvbj1udWxsLGN1cnJlbnREaXJlY3Rpb249bnVsbCxkdXJhdGlvbj0wLHN0YXJ0VG91Y2hlc0Rpc3RhbmNlPTAsZW5kVG91Y2hlc0Rpc3RhbmNlPTAscGluY2hab29tPTEscGluY2hEaXN0YW5jZT0wLHBpbmNoRGlyZWN0aW9uPTAsbWF4aW11bXNNYXA9bnVsbCwkZWxlbWVudD0kKGVsZW1lbnQpLHBoYXNlPVwic3RhcnRcIixmaW5nZXJDb3VudD0wLGZpbmdlckRhdGE9e30sc3RhcnRUaW1lPTAsZW5kVGltZT0wLHByZXZpb3VzVG91Y2hFbmRUaW1lPTAsZmluZ2VyQ291bnRBdFJlbGVhc2U9MCxkb3VibGVUYXBTdGFydFRpbWU9MCxzaW5nbGVUYXBUaW1lb3V0PW51bGwsaG9sZFRpbWVvdXQ9bnVsbDt0cnl7JGVsZW1lbnQuYmluZChTVEFSVF9FVix0b3VjaFN0YXJ0KSwkZWxlbWVudC5iaW5kKENBTkNFTF9FVix0b3VjaENhbmNlbCl9Y2F0Y2goZSl7JC5lcnJvcihcImV2ZW50cyBub3Qgc3VwcG9ydGVkIFwiK1NUQVJUX0VWK1wiLFwiK0NBTkNFTF9FVitcIiBvbiBqUXVlcnkuc3dpcGVcIil9dGhpcy5lbmFibGU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5kaXNhYmxlKCksJGVsZW1lbnQuYmluZChTVEFSVF9FVix0b3VjaFN0YXJ0KSwkZWxlbWVudC5iaW5kKENBTkNFTF9FVix0b3VjaENhbmNlbCksJGVsZW1lbnR9LHRoaXMuZGlzYWJsZT1mdW5jdGlvbigpe3JldHVybiByZW1vdmVMaXN0ZW5lcnMoKSwkZWxlbWVudH0sdGhpcy5kZXN0cm95PWZ1bmN0aW9uKCl7cmVtb3ZlTGlzdGVuZXJzKCksJGVsZW1lbnQuZGF0YShQTFVHSU5fTlMsbnVsbCksJGVsZW1lbnQ9bnVsbH0sdGhpcy5vcHRpb249ZnVuY3Rpb24ocHJvcGVydHksdmFsdWUpe2lmKFwib2JqZWN0XCI9PXR5cGVvZiBwcm9wZXJ0eSlvcHRpb25zPSQuZXh0ZW5kKG9wdGlvbnMscHJvcGVydHkpO2Vsc2UgaWYodm9pZCAwIT09b3B0aW9uc1twcm9wZXJ0eV0pe2lmKHZvaWQgMD09PXZhbHVlKXJldHVybiBvcHRpb25zW3Byb3BlcnR5XTtvcHRpb25zW3Byb3BlcnR5XT12YWx1ZX1lbHNle2lmKCFwcm9wZXJ0eSlyZXR1cm4gb3B0aW9uczskLmVycm9yKFwiT3B0aW9uIFwiK3Byb3BlcnR5K1wiIGRvZXMgbm90IGV4aXN0IG9uIGpRdWVyeS5zd2lwZS5vcHRpb25zXCIpfXJldHVybiBudWxsfX12YXIgVkVSU0lPTj1cIjEuNi4xOFwiLExFRlQ9XCJsZWZ0XCIsUklHSFQ9XCJyaWdodFwiLFVQPVwidXBcIixET1dOPVwiZG93blwiLElOPVwiaW5cIixPVVQ9XCJvdXRcIixOT05FPVwibm9uZVwiLEFVVE89XCJhdXRvXCIsU1dJUEU9XCJzd2lwZVwiLFBJTkNIPVwicGluY2hcIixUQVA9XCJ0YXBcIixET1VCTEVfVEFQPVwiZG91YmxldGFwXCIsTE9OR19UQVA9XCJsb25ndGFwXCIsSE9SSVpPTlRBTD1cImhvcml6b250YWxcIixWRVJUSUNBTD1cInZlcnRpY2FsXCIsQUxMX0ZJTkdFUlM9XCJhbGxcIixET1VCTEVfVEFQX1RIUkVTSE9MRD0xMCxQSEFTRV9TVEFSVD1cInN0YXJ0XCIsUEhBU0VfTU9WRT1cIm1vdmVcIixQSEFTRV9FTkQ9XCJlbmRcIixQSEFTRV9DQU5DRUw9XCJjYW5jZWxcIixTVVBQT1JUU19UT1VDSD1cIm9udG91Y2hzdGFydFwiaW4gd2luZG93LFNVUFBPUlRTX1BPSU5URVJfSUUxMD13aW5kb3cubmF2aWdhdG9yLm1zUG9pbnRlckVuYWJsZWQmJiF3aW5kb3cuUG9pbnRlckV2ZW50JiYhU1VQUE9SVFNfVE9VQ0gsU1VQUE9SVFNfUE9JTlRFUj0od2luZG93LlBvaW50ZXJFdmVudHx8d2luZG93Lm5hdmlnYXRvci5tc1BvaW50ZXJFbmFibGVkKSYmIVNVUFBPUlRTX1RPVUNILFBMVUdJTl9OUz1cIlRvdWNoU3dpcGVcIixkZWZhdWx0cz17ZmluZ2VyczoxLHRocmVzaG9sZDo3NSxjYW5jZWxUaHJlc2hvbGQ6bnVsbCxwaW5jaFRocmVzaG9sZDoyMCxtYXhUaW1lVGhyZXNob2xkOm51bGwsZmluZ2VyUmVsZWFzZVRocmVzaG9sZDoyNTAsbG9uZ1RhcFRocmVzaG9sZDo1MDAsZG91YmxlVGFwVGhyZXNob2xkOjIwMCxzd2lwZTpudWxsLHN3aXBlTGVmdDpudWxsLHN3aXBlUmlnaHQ6bnVsbCxzd2lwZVVwOm51bGwsc3dpcGVEb3duOm51bGwsc3dpcGVTdGF0dXM6bnVsbCxwaW5jaEluOm51bGwscGluY2hPdXQ6bnVsbCxwaW5jaFN0YXR1czpudWxsLGNsaWNrOm51bGwsdGFwOm51bGwsZG91YmxlVGFwOm51bGwsbG9uZ1RhcDpudWxsLGhvbGQ6bnVsbCx0cmlnZ2VyT25Ub3VjaEVuZDohMCx0cmlnZ2VyT25Ub3VjaExlYXZlOiExLGFsbG93UGFnZVNjcm9sbDpcImF1dG9cIixmYWxsYmFja1RvTW91c2VFdmVudHM6ITAsZXhjbHVkZWRFbGVtZW50czpcIi5ub1N3aXBlXCIscHJldmVudERlZmF1bHRFdmVudHM6ITB9OyQuZm4uc3dpcGU9ZnVuY3Rpb24obWV0aG9kKXt2YXIgJHRoaXM9JCh0aGlzKSxwbHVnaW49JHRoaXMuZGF0YShQTFVHSU5fTlMpO2lmKHBsdWdpbiYmXCJzdHJpbmdcIj09dHlwZW9mIG1ldGhvZCl7aWYocGx1Z2luW21ldGhvZF0pcmV0dXJuIHBsdWdpblttZXRob2RdLmFwcGx5KHBsdWdpbixBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMSkpOyQuZXJyb3IoXCJNZXRob2QgXCIrbWV0aG9kK1wiIGRvZXMgbm90IGV4aXN0IG9uIGpRdWVyeS5zd2lwZVwiKX1lbHNlIGlmKHBsdWdpbiYmXCJvYmplY3RcIj09dHlwZW9mIG1ldGhvZClwbHVnaW4ub3B0aW9uLmFwcGx5KHBsdWdpbixhcmd1bWVudHMpO2Vsc2UgaWYoIShwbHVnaW58fFwib2JqZWN0XCIhPXR5cGVvZiBtZXRob2QmJm1ldGhvZCkpcmV0dXJuIGluaXQuYXBwbHkodGhpcyxhcmd1bWVudHMpO3JldHVybiAkdGhpc30sJC5mbi5zd2lwZS52ZXJzaW9uPVZFUlNJT04sJC5mbi5zd2lwZS5kZWZhdWx0cz1kZWZhdWx0cywkLmZuLnN3aXBlLnBoYXNlcz17UEhBU0VfU1RBUlQ6UEhBU0VfU1RBUlQsUEhBU0VfTU9WRTpQSEFTRV9NT1ZFLFBIQVNFX0VORDpQSEFTRV9FTkQsUEhBU0VfQ0FOQ0VMOlBIQVNFX0NBTkNFTH0sJC5mbi5zd2lwZS5kaXJlY3Rpb25zPXtMRUZUOkxFRlQsUklHSFQ6UklHSFQsVVA6VVAsRE9XTjpET1dOLElOOklOLE9VVDpPVVR9LCQuZm4uc3dpcGUucGFnZVNjcm9sbD17Tk9ORTpOT05FLEhPUklaT05UQUw6SE9SSVpPTlRBTCxWRVJUSUNBTDpWRVJUSUNBTCxBVVRPOkFVVE99LCQuZm4uc3dpcGUuZmluZ2Vycz17T05FOjEsVFdPOjIsVEhSRUU6MyxGT1VSOjQsRklWRTo1LEFMTDpBTExfRklOR0VSU319KTtcblxuIiwiKGZ1bmN0aW9uICgpIHtcbmxldCBteU1hcDtcblxuY29uc3QgaW5pdCA9ICgpID0+IHtcbiAgbXlNYXAgPSBuZXcgeW1hcHMuTWFwKFwibWFwXCIsIHtcbiAgICBjZW50ZXI6IFs0NS4wNDA3NjgsIDM4Ljk4OTYxMl0sXG4gICAgem9vbTogMTIsXG4gICAgY29udHJvbHM6IFtdLFxuICB9KTtcblxuICBjb25zdCBjb29yZHMgPSBbXG4gICAgWzQ1LjA1Mzc4NywgMzguOTc0NjYzXSxcbiAgICBbNDUuMDIyODgyLCAzOS4xMDM4OTNdLFxuICAgIFs0NS4wMjM5MTMsIDM4LjkzODkwOF0sXG4gICAgWzQ1LjAwNzExMiwgMzguOTcxMDIzXVxuICBdO1xuXG4gIGNvbnN0IG1lZGlhUXVlcnlUYWJsZXRzID0gd2luZG93Lm1hdGNoTWVkaWEoJyhtYXgtd2lkdGg6IDc2OHB4KScpO1xuICBpZiAobWVkaWFRdWVyeVRhYmxldHMubWF0Y2hlcykge1xuICAgIHZhciBteUNvbGxlY3Rpb24gPSBuZXcgeW1hcHMuR2VvT2JqZWN0Q29sbGVjdGlvbih7fSwge1xuICAgIGRyYWdnYWJsZTogZmFsc2UsIFxuICAgIGljb25MYXlvdXQ6ICdkZWZhdWx0I2ltYWdlJyxcbiAgICBpY29uSW1hZ2VIcmVmOiBcIi4vaW1nL21hcmtlci5zdmdcIixcbiAgICBpY29uSW1hZ2VTaXplOiBbNDMsIDU1XSxcbiAgICBpY29uSW1hZ2VPZmZzZXQ6IFstMywgLTQyXVxuICB9KTtcbiAgfSBlbHNlIHtcbiAgICB2YXIgbXlDb2xsZWN0aW9uID0gbmV3IHltYXBzLkdlb09iamVjdENvbGxlY3Rpb24oe30sIHtcbiAgICAgIGRyYWdnYWJsZTogZmFsc2UsIFxuICAgICAgaWNvbkxheW91dDogJ2RlZmF1bHQjaW1hZ2UnLFxuICAgICAgaWNvbkltYWdlSHJlZjogXCIuL2ltZy9tYXJrZXIuc3ZnXCIsXG4gICAgICBpY29uSW1hZ2VTaXplOiBbNTgsIDczXSxcbiAgICAgIGljb25JbWFnZU9mZnNldDogWy0zLCAtNDJdXG4gICAgfSk7XG4gIH1cbiBcbiAgY29vcmRzLmZvckVhY2goY29vcmQgPT4ge1xuICAgIG15Q29sbGVjdGlvbi5hZGQobmV3IHltYXBzLlBsYWNlbWFyayhjb29yZCkpO1xuICB9KTtcblxuICBteU1hcC5nZW9PYmplY3RzLmFkZChteUNvbGxlY3Rpb24pO1xuXG4gIG15TWFwLmJlaGF2aW9ycy5kaXNhYmxlKCdzY3JvbGxab29tJyk7XG5cbn1cblxueW1hcHMucmVhZHkoaW5pdCk7XG59KSgpIiwiKGZ1bmN0aW9uICgpIHtcbmNvbnN0IGlzUGhvbmVzID0gd2luZG93Lm1hdGNoTWVkaWEoJyhtYXgtd2lkdGg6IDQ4MHB4KScpLm1hdGNoZXM7XG5jb25zdCBpc1RhYmxldHMgPSB3aW5kb3cubWF0Y2hNZWRpYSgnKG1heC13aWR0aDogODQwcHgpJykubWF0Y2hlcztcblxuXG5jb25zdCBtZXN1cmVXaWR0aCA9IGl0ZW0gPT4ge1xuICBsZXQgcmVxSXRlbVdpZHRoID0gMDtcblxuICBjb25zdCBzY3JlZW5XaWR0aCA9ICQod2luZG93KS53aWR0aCgpO1xuICBjb25zdCBjb250YWluZXIgPSBpdGVtLmNsb3Nlc3QoXCIucHJvZHVjdHMtbWVudVwiKTtcbiAgY29uc3QgdGl0bGVzQmxvY2tzID0gY29udGFpbmVyLmZpbmQoXCIucHJvZHVjdHMtbWVudV9fdGl0bGVcIik7XG4gIGNvbnN0IHRpdGxlV2lkdGggPSB0aXRsZXNCbG9ja3Mud2lkdGgoKSAqIHRpdGxlc0Jsb2Nrcy5sZW5ndGg7XG5cbiAgY29uc3QgdGV4dENvbnRhaW5lciA9IGl0ZW0uZmluZChcIi5wcm9kdWN0cy1tZW51X19jb250ZW50LXRleHRcIik7XG4gIGNvbnN0IHBhZGRpbmdMZWZ0ID0gcGFyc2VJbnQodGV4dENvbnRhaW5lci5jc3MoXCJwYWRkaW5nLWxlZnRcIikpO1xuICBjb25zdCBwYWRkaW5nUmlnaHQgPSBwYXJzZUludCh0ZXh0Q29udGFpbmVyLmNzcyhcInBhZGRpbmctcmlnaHRcIikpO1xuXG4gXG4gIGlmIChpc1Bob25lcykge1xuICAgIHJlcUl0ZW1XaWR0aCA9IHNjcmVlbldpZHRoIC0gdGl0bGVzQmxvY2tzLndpZHRoKCk7XG4gIH0gZWxzZSBpZiAoaXNUYWJsZXRzKSB7XG4gICAgcmVxSXRlbVdpZHRoID0gc2NyZWVuV2lkdGggLSB0aXRsZVdpZHRoO1xuICB9IGVsc2Uge1xuICAgIHJlcUl0ZW1XaWR0aCA9IDUyNDtcbiAgfVxuXG4gIFxuICByZXR1cm4ge1xuICAgIGNvbnRhaW5lcjogcmVxSXRlbVdpZHRoLFxuICAgIHRleHRDb250YWluZXI6IHJlcUl0ZW1XaWR0aCAtIHBhZGRpbmdMZWZ0IC0gcGFkZGluZ1JpZ2h0XG4gIH1cblxufTtcblxuXG5jb25zdCBjbG9zZUV2ZXJ5SXRlbUluQ29udGFpbmVyID0gY29udGFpbmVyID0+IHtcbiAgY29uc3QgaXRlbXMgPSBjb250YWluZXIuZmluZChcIi5wcm9kdWN0cy1tZW51X19pdGVtXCIpO1xuICBjb25zdCBjb250ZW50ID0gY29udGFpbmVyLmZpbmQoXCIucHJvZHVjdHMtbWVudV9fY29udGVudFwiKTtcblxuICBpdGVtcy5yZW1vdmVDbGFzcyhcImFjdGl2ZVwiKTtcbiAgY29udGVudC53aWR0aCgwKTtcbn1cblxuXG5jb25zdCBvcGVuVGhpc0l0ZW0gPSAoaXRlbSkgPT4ge1xuICBjb25zdCBoaWRkZW5Db250ZW50ID0gaXRlbS5maW5kKFwiLnByb2R1Y3RzLW1lbnVfX2NvbnRlbnRcIik7XG4gIGNvbnN0IHJlcVdpZHRoID0gbWVzdXJlV2lkdGgoaXRlbSk7XG4gIGNvbnN0IHRleHRCbG9jayA9IGl0ZW0uZmluZChcIi5wcm9kdWN0cy1tZW51X19jb250ZW50LXRleHRcIik7XG5cbiAgaXRlbS5hZGRDbGFzcyhcImFjdGl2ZVwiKTtcbiAgaGlkZGVuQ29udGVudC53aWR0aChyZXFXaWR0aC5jb250YWluZXIpO1xuICB0ZXh0QmxvY2sud2lkdGgocmVxV2lkdGgudGV4dENvbnRhaW5lcik7XG59XG5cblxuJChcIi5wcm9kdWN0cy1tZW51X190aXRsZVwiKS5vbihcImNsaWNrXCIsIGUgPT4ge1xuICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgY29uc3QgJHRoaXMgPSAkKGUuY3VycmVudFRhcmdldCk7XG4gIGNvbnN0IGl0ZW0gPSAkdGhpcy5jbG9zZXN0KFwiLnByb2R1Y3RzLW1lbnVfX2l0ZW1cIik7XG4gIGNvbnN0IGl0ZW1PcGVuZWQgPSBpdGVtLmhhc0NsYXNzKFwiYWN0aXZlXCIpO1xuICBjb25zdCBjb250YWluZXIgPSAkdGhpcy5jbG9zZXN0KFwiLnByb2R1Y3RzLW1lbnVcIik7IFxuXG4gIFxuICBpZiAoaXRlbU9wZW5lZCkge1xuICAgIGNsb3NlRXZlcnlJdGVtSW5Db250YWluZXIoY29udGFpbmVyKTtcbiAgfSBlbHNlIHtcbiAgICBjbG9zZUV2ZXJ5SXRlbUluQ29udGFpbmVyKGNvbnRhaW5lcik7IFxuICAgIG9wZW5UaGlzSXRlbShpdGVtKTsgXG4gIH1cblxuICBcbiAgaWYgKGlzUGhvbmVzKSB7XG4gICAgaWYgKGl0ZW0uaGFzQ2xhc3MoXCJhY3RpdmUtbW9iaWxlXCIpKSB7XG4gICAgICBpdGVtLnJlbW92ZUNsYXNzKFwiYWN0aXZlLW1vYmlsZVwiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgaXRlbS5hZGRDbGFzcyhcImFjdGl2ZS1tb2JpbGVcIik7XG4gICAgfVxuICB9XG59KTtcbn0pKCkiLCIoZnVuY3Rpb24gKCkge1xuY29uc3QgdmFsaWRhdGVGaWVsZHMgPSAoZm9ybSwgZmllbGRzQXJyYXkpID0+IHtcbiAgZmllbGRzQXJyYXkuZm9yRWFjaChmaWVsZCA9PiB7XG4gICAgZmllbGQucmVtb3ZlQ2xhc3MoXCJmb3JtX19pbnB1dC0tZXJyb3JcIik7XG4gICAgaWYgKGZpZWxkLnZhbCgpLnRyaW0oKSA9PSBcIlwiKSB7XG4gICAgICBmaWVsZC5hZGRDbGFzcyhcImZvcm1fX2lucHV0LS1lcnJvclwiKTtcbiAgICB9XG4gIH0pO1xuXG4gIGNvbnN0IGVycm9yRmllbGRzID0gZm9ybS5maW5kKFwiLmZvcm1fX2lucHV0LS1lcnJvclwiKTtcblxuICByZXR1cm4gZXJyb3JGaWVsZHMubGVuZ3RoID09IDA7XG59XG5cbiQoJy5mb3JtJykuc3VibWl0KGUgPT4ge1xuICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgY29uc3QgZm9ybSA9ICQoZS5jdXJyZW50VGFyZ2V0KTtcbiAgY29uc3QgbmFtZSA9IGZvcm0uZmluZChcIltuYW1lPSduYW1lJ11cIik7XG4gIGNvbnN0IHBob25lID0gZm9ybS5maW5kKFwiW25hbWU9J3Bob25lJ11cIik7XG4gIGNvbnN0IGNvbW1lbnQgPSBmb3JtLmZpbmQoXCJbbmFtZT0nY29tbWVudCddXCIpO1xuICBjb25zdCB0byA9IGZvcm0uZmluZChcIltuYW1lPSd0byddXCIpO1xuXG4gIGNvbnN0IG1vZGFsID0gJChcIiNtb2RhbFwiKTtcbiAgY29uc3QgY29udGVudCA9IG1vZGFsLmZpbmQoXCIubW9kYWxfX2NvbnRlbnRcIik7XG5cbiAgbW9kYWwucmVtb3ZlQ2xhc3MoXCJlcnJvci1tb2RhbFwiKTtcblxuICBjb25zdCBpc1ZhbGlkID0gdmFsaWRhdGVGaWVsZHMoZm9ybSwgW25hbWUsIHBob25lLCBjb21tZW50LCB0b10pO1xuXG4gIGlmIChpc1ZhbGlkKSB7XG4gICAgY29uc3QgcmVxdWVzdCA9ICQuYWpheCh7XG4gICAgICB1cmw6IFwiaHR0cHM6Ly93ZWJkZXYtYXBpLmxvZnRzY2hvb2wuY29tL3NlbmRtYWlsXCIsXG4gICAgICBtZXRob2Q6IFwicG9zdFwiLFxuICAgICAgZGF0YToge1xuICAgICAgICBuYW1lOiBuYW1lLnZhbCgpLFxuICAgICAgICBwaG9uZTogcGhvbmUudmFsKCksXG4gICAgICAgIGNvbW1lbnQ6IGNvbW1lbnQudmFsKCksXG4gICAgICAgIHRvOiB0by52YWwoKSxcbiAgICAgIH0sXG4gICAgICBlcnJvcjogZGF0YSA9PiB7XG5cbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHJlcXVlc3QuZG9uZShkYXRhID0+IHtcbiAgICAgIGNvbnRlbnQudGV4dChkYXRhLm1lc3NhZ2UpO1xuICAgIH0pO1xuXG4gICAgcmVxdWVzdC5mYWlsKGRhdGEgPT4ge1xuICAgICAgY29uc3QgbWVzc2FnZSA9IGRhdGEucmVzcG9uc2VKU09OLm1lc3NhZ2U7XG4gICAgICBjb250ZW50LnRleHQobWVzc2FnZSk7XG4gICAgICBtb2RhbC5hZGRDbGFzcyhcImVycm9yLW1vZGFsXCIpO1xuICAgIH0pO1xuXG4gICAgcmVxdWVzdC5hbHdheXMoKCkgPT4ge1xuICAgICAgJC5mYW5jeWJveC5vcGVuKHtcbiAgICAgICAgc3JjOiBcIiNtb2RhbFwiLFxuICAgICAgICB0eXBlOiBcImlubGluZVwiXG4gICAgICB9KVxuICAgIH0pXG4gIH1cbn0pO1xuXG4kKFwiLmFwcC1zdWJtaXQtYnRuXCIpLmNsaWNrKGUgPT4ge1xuICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgJC5mYW5jeWJveC5jbG9zZSgpO1xufSk7XG59KSgpIiwiKGZ1bmN0aW9uICgpIHtcbmNvbnN0IHNlY3Rpb25zID0gJChcInNlY3Rpb25cIik7XG5jb25zdCBkaXNwbGF5ID0gJChcIi5tYWluY29udGVudFwiKTtcbmNvbnN0IHNpZGVNZW51ID0gJChcIi5maXhlZC1tZW51XCIpO1xuY29uc3QgbWVudUl0ZW1zID0gc2lkZU1lbnUuZmluZChcIi5maXhlZC1tZW51X19pdGVtXCIpO1xuXG5sZXQgaW5TY3JvbGwgPSBmYWxzZTtcblxuXG5cbmNvbnN0IG1vYmlsZURldGVjdCA9IG5ldyBNb2JpbGVEZXRlY3Qod2luZG93Lm5hdmlnYXRvci51c2VyQWdlbnQpO1xuY29uc3QgaXNNb2JpbGUgPSBtb2JpbGVEZXRlY3QubW9iaWxlKCk7XG5cbnNlY3Rpb25zLmZpcnN0KCkuYWRkQ2xhc3MoXCJhY3RpdmVcIik7XG4kKFwiLmZpeGVkLW1lbnVfX2l0ZW1cIikuZmlyc3QoKS5hZGRDbGFzcyhcImZpeGVkLW1lbnVfX2l0ZW0tLWFjdGl2ZVwiKTtcblxuXG5jb25zdCBjb3VudFNlY3Rpb25Qb3NpdGlvbiA9IHNlY3Rpb25FcSA9PiB7XG4gIGNvbnN0IHBvc2l0aW9uID0gc2VjdGlvbkVxICogLTEwMDtcblxuICBpZiAoaXNOYU4ocG9zaXRpb24pKSB7XG4gICAgY29uc29sZS5lcnJvcign0L/QtdGA0LXQtNCw0L3QviDQvdC10LLQtdGA0L3QvtC1INC30L3QsNGH0LXQvdC40LUg0LIgY291bnRTZWN0aW9uUG9zaXRpb24nKTtcbiAgICByZXR1cm4gMDtcbiAgfVxuICByZXR1cm4gcG9zaXRpb247XG59XG5cblxuY29uc3QgY2hhbmdlTWVudVRoZW1lRm9yU2VjdGlvbiA9IChzZWN0aW9uRXEpID0+IHtcbiAgY29uc3QgY3VycmVudFNlY3Rpb24gPSBzZWN0aW9ucy5lcShzZWN0aW9uRXEpO1xuICBjb25zdCBtZW51VGhlbWUgPSBjdXJyZW50U2VjdGlvbi5hdHRyKFwiZGF0YS1zaWRlbWVudS10aGVtZVwiKVxuICBjb25zdCBhY3RpdmVDbGFzcyA9IFwiZml4ZWQtbWVudV9faXRlbS0tYWN0aXZlXCI7XG5cbiAgc2lkZU1lbnUuZmluZChcIi5maXhlZC1tZW51X19pdGVtXCIpLmVxKHNlY3Rpb25FcSkuYWRkQ2xhc3MoYWN0aXZlQ2xhc3MpLnNpYmxpbmdzKCkucmVtb3ZlQ2xhc3MoYWN0aXZlQ2xhc3MpO1xuXG4gIGlmIChtZW51VGhlbWUgPT09IFwiZGFya1wiKSB7XG4gICAgc2lkZU1lbnUuYWRkQ2xhc3MoXCJmaXhlZC1tZW51LS10aGVtZS1kYXJrXCIpO1xuICB9IGVsc2Uge1xuICAgIHNpZGVNZW51LnJlbW92ZUNsYXNzKFwiZml4ZWQtbWVudS0tdGhlbWUtZGFya1wiKTtcbiAgfVxufVxuXG5cbmNvbnN0IHJlc2V0QWN0aXZlQ2xhc3NGb3JJdGVtID0gKGl0ZW1zLCBpdGVtRXEsIGFjdGl2ZUNsYXNzKSA9PiB7XG4gIGl0ZW1zLmVxKGl0ZW1FcSkuYWRkQ2xhc3MoYWN0aXZlQ2xhc3MpLnNpYmxpbmdzKCkucmVtb3ZlQ2xhc3MoYWN0aXZlQ2xhc3MpO1xufVxuXG5cbmNvbnN0IHBlcmZvcm1UcmFuc2l0aW9uID0gc2VjdGlvbkVxID0+IHtcblxuICBpZiAoaW5TY3JvbGwpIHJldHVybjtcblxuICBjb25zdCB0cmFuc2l0aW9uT3ZlciA9IDEwMDA7XG4gIGNvbnN0IG1vdXNlSW5lcnRpb25PdmVyID0gMzAwO1xuXG4gIGluU2Nyb2xsID0gdHJ1ZTtcbiAgY29uc3QgcG9zaXRpb24gPSBjb3VudFNlY3Rpb25Qb3NpdGlvbihzZWN0aW9uRXEpO1xuXG4gIGNoYW5nZU1lbnVUaGVtZUZvclNlY3Rpb24oc2VjdGlvbkVxKTtcblxuICBkaXNwbGF5LmNzcyh7XG4gICAgdHJhbnNmb3JtOiBgdHJhbnNsYXRlWSgke3Bvc2l0aW9ufSUpYFxuICB9KTtcblxuICByZXNldEFjdGl2ZUNsYXNzRm9ySXRlbShzZWN0aW9ucywgc2VjdGlvbkVxLCBcImFjdGl2ZVwiKTtcblxuXG5cbiAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgaW5TY3JvbGwgPSBmYWxzZTtcbiAgICByZXNldEFjdGl2ZUNsYXNzRm9ySXRlbShtZW51SXRlbXMsIHNlY3Rpb25FcSwgXCJmaXhlZC1tZW51X19pdGVtLS1hY3RpdmVcIik7XG4gIH0sIHRyYW5zaXRpb25PdmVyICsgbW91c2VJbmVydGlvbk92ZXIpO1xuXG59O1xuXG5cbmNvbnN0IHZpZXdwb3J0U2Nyb2xsZXIgPSAoKSA9PiB7XG4gIGNvbnN0IGFjdGl2ZVNlY3Rpb24gPSBzZWN0aW9ucy5maWx0ZXIoXCIuYWN0aXZlXCIpO1xuICBjb25zdCBuZXh0U2VjdGlvbiA9IGFjdGl2ZVNlY3Rpb24ubmV4dCgpO1xuICBjb25zdCBwcmV2U2VjdGlvbiA9IGFjdGl2ZVNlY3Rpb24ucHJldigpO1xuXG4gIHJldHVybiB7XG4gICAgbmV4dCgpIHtcbiAgICAgIGlmIChuZXh0U2VjdGlvbi5sZW5ndGgpIHtcbiAgICAgICAgcGVyZm9ybVRyYW5zaXRpb24obmV4dFNlY3Rpb24uaW5kZXgoKSk7XG4gICAgICB9XG4gICAgfSxcbiAgICBwcmV2KCkge1xuICAgICAgaWYgKHByZXZTZWN0aW9uLmxlbmd0aCkge1xuICAgICAgICBwZXJmb3JtVHJhbnNpdGlvbihwcmV2U2VjdGlvbi5pbmRleCgpKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbn07XG5cblxuJCh3aW5kb3cpLm9uKFwid2hlZWxcIiwgZSA9PiB7XG4gIGNvbnN0IGRlbHRhWSA9IGUub3JpZ2luYWxFdmVudC5kZWx0YVk7XG4gIGNvbnN0IHNjcm9sbGVyID0gdmlld3BvcnRTY3JvbGxlcigpO1xuXG4gIGlmIChkZWx0YVkgPiAwKSB7XG4gICAgc2Nyb2xsZXIubmV4dCgpO1xuICB9XG5cbiAgaWYgKGRlbHRhWSA8IDApIHtcbiAgICBzY3JvbGxlci5wcmV2KCk7XG4gIH1cbn0pO1xuXG5cbiQod2luZG93KS5vbihcImtleWRvd25cIiwgKGUpID0+IHtcblxuICBjb25zdCB0YWdOYW1lID0gZS50YXJnZXQudGFnTmFtZS50b0xvd2VyQ2FzZSgpO1xuICBjb25zdCB1c2VyVHlwaW5nSW5JbnB1dHMgPSB0YWdOYW1lID09IFwiaW5wdXRcIiB8fCB0YWdOYW1lID09IFwidGV4dGFyZWFcIjtcbiAgY29uc3Qgc2Nyb2xsZXIgPSB2aWV3cG9ydFNjcm9sbGVyKCk7XG5cbiAgaWYgKHVzZXJUeXBpbmdJbklucHV0cykgcmV0dXJuO1xuXG4gXG4gIHN3aXRjaCAoZS5rZXlDb2RlKSB7XG4gICAgY2FzZSAzODogXG4gICAgICBzY3JvbGxlci5wcmV2KCk7XG4gICAgICBicmVhaztcblxuICAgIGNhc2UgNDA6IFxuICAgICAgc2Nyb2xsZXIubmV4dCgpO1xuICAgICAgYnJlYWs7XG4gIH1cblxufSk7XG5cbiQoXCIud3JhcHBlclwiKS5vbihcInRvdWNobW92ZVwiLCBlID0+IGUucHJldmVudERlZmF1bHQoKSk7XG5cblxuJChcIltkYXRhLXNjcm9sbC10b11cIikub24oXCJjbGlja1wiLCBlID0+IHtcbiAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gIGNvbnN0ICR0aGlzID0gJChlLmN1cnJlbnRUYXJnZXQpO1xuICBjb25zdCB0YXJnZXQgPSAkdGhpcy5hdHRyKFwiZGF0YS1zY3JvbGwtdG9cIik7XG4gIGNvbnN0IHJlcVNlY3Rpb24gPSAkKGBbZGF0YS1zZWN0aW9uLWlkPSR7dGFyZ2V0fV1gKTtcblxuICBwZXJmb3JtVHJhbnNpdGlvbihyZXFTZWN0aW9uLmluZGV4KCkpO1xufSk7XG5cblxuaWYgKGlzTW9iaWxlKSB7XG4gICQoXCJib2R5XCIpLnN3aXBlKHtcbiAgICBzd2lwZTogZnVuY3Rpb24gKGV2ZW50LCBkaXJlY3Rpb24pIHtcbiAgICAgIGNvbnN0IHNjcm9sbGVyID0gdmlld3BvcnRTY3JvbGxlcigpO1xuICAgICAgbGV0IHNjcm9sbERpcmVjcmlvbiA9IFwiXCI7XG5cbiAgICAgIGlmIChkaXJlY3Rpb24gPT09IFwidXBcIikgc2Nyb2xsRGlyZWNyaW9uID0gXCJuZXh0XCI7XG4gICAgICBpZiAoZGlyZWN0aW9uID09PSBcImRvd25cIikgc2Nyb2xsRGlyZWNyaW9uID0gXCJwcmV2XCI7XG5cbiAgICAgIHNjcm9sbGVyW3Njcm9sbERpcmVjcmlvbl0oKTtcbiAgICB9XG4gIH0pO1xufVxufSkoKSIsIihmdW5jdGlvbiAoKSB7XG5jb25zdCBwbGF5ZXJDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucGxheWVyJyk7XG5jb25zdCBwbGF5ZXJXcmFwcGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBsYXllcl9fd3JhcHBlcicpO1xuY29uc3QgdmlkZW8gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucGxheWVyX192aWRlbycpO1xuY29uc3QgcGxheWVyU3RhcnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucGxheWVyX19jb250cm9scy1zdGFydCcpO1xuY29uc3QgcGxheWVyUGF1c2VkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBsYXllcl9fcGF1c2VkJyk7XG5jb25zdCBwcm9ncmVzc0JhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wbGF5ZXJfX3BsYXliYWNrLWxpbmUnKTtcbmNvbnN0IHBsYXllclZpZGVvQ2lyY2xlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBsYXllcl9fcGxheWJhY2stY2lyY2xlJyk7XG5jb25zdCBwbGF5ZXJWb2x1bWVJY29uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBsYXllcl9fbXV0ZScpO1xuY29uc3QgcGxheWVyVm9sdW1lQmFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBsYXllcl9fdm9sdW1lLWxpbmUnKTtcbmNvbnN0IHBsYXllclZvbHVtZUNpcmNsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wbGF5ZXJfX3ZvbHVtZS1jaXJjbGUnKTtcblxubGV0IHN0YXJ0Vm9sdW1lID0gMDtcbmxldCBjdXJyZW50Vm9sdW1lO1xuXG5cblxuY29uc3QgaGFuZGxlU3RhcnQgPSAoKSA9PiB7XG4gIGlmICh2aWRlby5wYXVzZWQpIHtcbiAgICB2aWRlby5wbGF5KCk7XG4gIH0gZWxzZSB7XG4gICAgdmlkZW8ucGF1c2UoKTtcbiAgfSAgXG59XG5cbnBsYXllclN0YXJ0LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgaGFuZGxlU3RhcnQpO1xucGxheWVyUGF1c2VkLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgaGFuZGxlU3RhcnQpO1xucGxheWVyV3JhcHBlci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGhhbmRsZVN0YXJ0KTtcblxuXG5cbnZpZGVvLm9ucGxheSA9ICgpID0+IHtcbiAgdG9nZ2xlUGxheWVyKCk7XG59XG5cbnZpZGVvLm9ucGF1c2UgPSAoKSA9PiB7XG4gIHRvZ2dsZVBsYXllcihcInBhdXNlXCIpO1xufVxuXG5jb25zdCB0b2dnbGVQbGF5ZXIgPSAoYWN0aW9uID0gXCJzdGFydFwiKSA9PiB7XG4gIGlmIChhY3Rpb24gPT09IFwic3RhcnRcIikge1xuICAgIHBsYXllckNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKFwiYWN0aXZlXCIpO1xuICB9IGVsc2Uge1xuICAgIHBsYXllckNvbnRhaW5lci5jbGFzc0xpc3QucmVtb3ZlKFwiYWN0aXZlXCIpO1xuICB9XG59XG5cblxuXG5jb25zdCBjaGFuZ2VWb2x1bWUgPSAoZSkgPT4ge1xuICBjb25zdCBjdXJyZW50VGFyZ2V0ID0gZS5jdXJyZW50VGFyZ2V0O1xuICBjb25zdCBsZWZ0ID0gY3VycmVudFRhcmdldC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5sZWZ0O1xuICBjb25zdCBzb3VuZEJhcldpZHRoID0gcGFyc2VJbnQoZ2V0Q29tcHV0ZWRTdHlsZShjdXJyZW50VGFyZ2V0KS53aWR0aCk7XG4gIGNvbnN0IG5ld1Bvc2l0aW9uID0gZS5wYWdlWCAtIGxlZnQ7IFxuICBjb25zdCBwZXJjZW50VmFsdWUgPSAobmV3UG9zaXRpb24gLyBzb3VuZEJhcldpZHRoKSAqIDEwMDtcblxuICB2aWRlby52b2x1bWUgPSBwZXJjZW50VmFsdWUgLyAxMDA7XG4gIHBsYXllclZvbHVtZUNpcmNsZS5zdHlsZS5sZWZ0ID0gYCR7cGVyY2VudFZhbHVlfSVgOyBcblxuXG4gIGlmICh2aWRlby52b2x1bWUgPiAwKSB7XG4gICAgcGxheWVyQ29udGFpbmVyLmNsYXNzTGlzdC5yZW1vdmUoJ211dGVkJyk7XG4gIH1cbn1cblxuY29uc3QgdG9nZ2xlU291bmQgPSAoKSA9PiB7XG4gIHBsYXllckNvbnRhaW5lci5jbGFzc0xpc3QudG9nZ2xlKCdtdXRlZCcpO1xuXG4gIGlmICh2aWRlby52b2x1bWUgPT09IDApIHtcbiAgIFxuICAgIHZpZGVvLnZvbHVtZSA9IGN1cnJlbnRWb2x1bWU7XG4gICAgcGxheWVyVm9sdW1lQ2lyY2xlLnN0eWxlLmxlZnQgPSBgJHtjdXJyZW50Vm9sdW1lICogMTAwfSVgO1xuICB9IGVsc2Uge1xuICAgXG4gICAgY3VycmVudFZvbHVtZSA9IHZpZGVvLnZvbHVtZTtcbiAgICB2aWRlby52b2x1bWUgPSBzdGFydFZvbHVtZTtcbiAgICBwbGF5ZXJWb2x1bWVDaXJjbGUuc3R5bGUubGVmdCA9IGAke3N0YXJ0Vm9sdW1lfSVgO1xuICB9XG59XG5cbnBsYXllclZvbHVtZUljb24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0b2dnbGVTb3VuZCk7XG5wbGF5ZXJWb2x1bWVCYXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBjaGFuZ2VWb2x1bWUpO1xuXG5cblxuY29uc3QgaGFuZGxlRHVyYXRpb24gPSAoZSkgPT4ge1xuICBjb25zdCBiYXJTaXplID0gcGFyc2VJbnQoZ2V0Q29tcHV0ZWRTdHlsZShwcm9ncmVzc0Jhcikud2lkdGgpO1xuICBjb25zdCBjaXJjbGVXaWR0aCA9IHBhcnNlSW50KGdldENvbXB1dGVkU3R5bGUocGxheWVyVmlkZW9DaXJjbGUpLndpZHRoKTtcbiAgY29uc3Qgb2Zmc2V0WCA9IGUub2Zmc2V0WDtcblxuICBjb25zdCBuZXdTaXplID0gb2Zmc2V0WCArIGNpcmNsZVdpZHRoIC8gMjtcbiAgY29uc3QgbmV3VGltZSA9IChuZXdTaXplICogdmlkZW8uZHVyYXRpb24pIC8gYmFyU2l6ZTtcbiAgdmlkZW8uY3VycmVudFRpbWUgPSBuZXdUaW1lO1xufVxuXG5jb25zdCB1cGRhdGVUaW1lID0gKCkgPT4ge1xuICBjb25zdCBsaW5lQmFyID0gdmlkZW8uY3VycmVudFRpbWUgLyB2aWRlby5kdXJhdGlvbjtcbiAgcGxheWVyVmlkZW9DaXJjbGUuc3R5bGUubGVmdCA9IGAke2xpbmVCYXIgKiAxMDB9JWA7XG5cbiAgaWYgKHZpZGVvLmVuZGVkKSB7XG4gICAgdmlkZW8uY3VycmVudFRpbWUgPSAwO1xuICB9XG59XG5cbnByb2dyZXNzQmFyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgaGFuZGxlRHVyYXRpb24pO1xudmlkZW8uYWRkRXZlbnRMaXN0ZW5lcigndGltZXVwZGF0ZScsIHVwZGF0ZVRpbWUpO1xufSkoKSIsIihmdW5jdGlvbiAoKSB7XG4gICQoJy5zbGlkZXJfX2xpc3QnKS5zbGljayh7XG4gICAgIHByZXZBcnJvdzogJCgnLnNsaWRlcl9fYnRuLS1sZWZ0JyksXG4gICAgIG5leHRBcnJvdzogJCgnLnNsaWRlcl9fYnRuLS1yaWdodCcpLFxuICAgfSk7XG4gfSkoKSIsIihmdW5jdGlvbiAoKSB7XG5jb25zdCBmaW5kQmxvY2tCeUFsaWFzID0gKGFsaWFzKSA9PiB7XG4gIHJldHVybiAkKFwiLnJldmlld3NfX2l0ZW1cIikuZmlsdGVyKChuZHgsIGl0ZW0pID0+IHtcbiAgICByZXR1cm4gJChpdGVtKS5hdHRyKFwiZGF0YS1saW5rZWQtd2l0aFwiKSA9PSBhbGlhc1xuICB9KTtcbn1cblxuJChcIi5pbnRlcmFjdGl2ZS1hdmF0YXJfX2xpbmtcIikuY2xpY2soZSA9PiB7XG4gIGUucHJldmVudERlZmF1bHQoKTtcblxuICBjb25zdCAkdGhpcyA9ICQoZS5jdXJyZW50VGFyZ2V0KTtcbiAgY29uc3QgdGFyZ2V0ID0gJHRoaXMuYXR0cihcImRhdGEtb3BlblwiKTtcbiAgY29uc3QgaXRlbVRvU2hvdyA9IGZpbmRCbG9ja0J5QWxpYXModGFyZ2V0KTtcbiAgY29uc3QgY3VySXRlbSA9ICR0aGlzLmNsb3Nlc3QoXCIucmV2aWV3c19fc3dpdGNoZXItaXRlbVwiKTtcblxuICBpdGVtVG9TaG93LmFkZENsYXNzKFwiYWN0aXZlXCIpLnNpYmxpbmdzKCkucmVtb3ZlQ2xhc3MoXCJhY3RpdmVcIik7XG4gIGN1ckl0ZW0uYWRkQ2xhc3MoXCJhY3RpdmVcIikuc2libGluZ3MoKS5yZW1vdmVDbGFzcyhcImFjdGl2ZVwiKTtcbn0pO1xufSkoKSJdfQ==
